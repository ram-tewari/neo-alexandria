# ============================================================================
# DATABASE CONFIGURATION
# ============================================================================

# Primary Database Connection
# Choose ONE of the following based on your deployment scenario:

# Option 1: SQLite (Development & Testing)
# - Zero configuration, file-based database
# - Perfect for local development and small deployments
# - Limitations: Single writer, no advanced features
DATABASE_URL=sqlite:///./neo_alexandria.db

# Option 2: PostgreSQL via Docker (Local Development)
# - Run: cd backend/docker && docker-compose up -d postgres
# - Provides production-like environment locally
# DATABASE_URL=postgresql://postgres:password@localhost:5432/backend

# Option 3: PostgreSQL Production (Self-Hosted)
# - Requires PostgreSQL 15+ installed and configured
# - Replace with your actual credentials and host
# DATABASE_URL=postgresql://neo_user:secure_password@db-server:5432/neo_alexandria

# Option 4: PostgreSQL Production (Managed Service)
# - AWS RDS example:
# DATABASE_URL=postgresql://admin:password@neo-alexandria.abc123.us-east-1.rds.amazonaws.com:5432/neo_alexandria
# - Google Cloud SQL example:
# DATABASE_URL=postgresql://neo_user:password@/neo_alexandria?host=/cloudsql/project:region:instance
# - Azure Database example:
# DATABASE_URL=postgresql://neo_user@server:password@server.postgres.database.azure.com:5432/neo_alexandria?sslmode=require

# PostgreSQL with SSL (Production Recommended)
# DATABASE_URL=postgresql://user:password@host:5432/database?sslmode=require

# PostgreSQL with Connection Pool Parameters
# DATABASE_URL=postgresql://user:password@host:5432/database?pool_size=20&max_overflow=40

# ============================================================================
# TEST DATABASE CONFIGURATION
# ============================================================================

# Test Database Connection (Optional)
# If not set, tests will use in-memory SQLite by default
# Set this to test against PostgreSQL or a specific test database

# Option 1: In-Memory SQLite (Default - Fast)
# TEST_DATABASE_URL=sqlite:///:memory:

# Option 2: File-Based SQLite (Persistent for debugging)
# TEST_DATABASE_URL=sqlite:///./test_neo_alexandria.db

# Option 3: PostgreSQL Test Database (Production Compatibility)
# - Recommended for CI/CD pipelines
# - Verifies PostgreSQL-specific features
# TEST_DATABASE_URL=postgresql://postgres:password@localhost:5432/test_backend

# Option 4: Separate PostgreSQL Test Instance
# TEST_DATABASE_URL=postgresql://test_user:test_password@test-db:5432/test_neo_alexandria

# Benefits of TEST_DATABASE_URL:
# - Test against PostgreSQL to verify production compatibility
# - Use a dedicated test database to avoid conflicts with development data
# - Override the default in-memory SQLite for integration tests
# - Validate database-specific features (JSONB, full-text search, etc.)

# ============================================================================
# DATABASE MIGRATION NOTES
# ============================================================================

# When switching from SQLite to PostgreSQL:
# 1. Run: alembic upgrade head
# 2. Run: python backend/scripts/migrate_sqlite_to_postgresql.py \
#         --source sqlite:///./backend.db \
#         --target postgresql://user:password@host:5432/database \
#         --validate
# 3. Update DATABASE_URL above
# 4. Restart application

# When rolling back from PostgreSQL to SQLite:
# 1. Run: python backend/scripts/migrate_postgresql_to_sqlite.py \
#         --source postgresql://user:password@host:5432/database \
#         --target sqlite:///./backend.db \
#         --validate
# 2. Update DATABASE_URL above
# 3. Restart application
# Note: Some PostgreSQL features (JSONB, full-text search) will be downgraded

ENV=dev
MIN_QUALITY_THRESHOLD=0.7
BACKUP_FREQUENCY=weekly
TIMEZONE=UTC

# ============================================================================
# PHASE 17: AUTHENTICATION AND SECURITY
# ============================================================================

# JWT Configuration
# Generate a secure secret key: python -c "import secrets; print(secrets.token_urlsafe(32))"
JWT_SECRET_KEY=your-secret-key-change-in-production-REQUIRED
JWT_ALGORITHM=HS256
JWT_ACCESS_TOKEN_EXPIRE_MINUTES=30
JWT_REFRESH_TOKEN_EXPIRE_DAYS=7

# OAuth2 Providers (Optional - for social login)
# Google OAuth2 Setup:
# 1. Go to https://console.cloud.google.com/apis/credentials
# 2. Create OAuth 2.0 Client ID
# 3. Add authorized redirect URI: http://localhost:8000/auth/google/callback (dev)
#                                 https://your-domain.com/auth/google/callback (prod)
GOOGLE_CLIENT_ID=your-google-client-id
GOOGLE_CLIENT_SECRET=your-google-client-secret
GOOGLE_REDIRECT_URI=http://localhost:8000/auth/google/callback

# GitHub OAuth2 Setup:
# 1. Go to https://github.com/settings/developers
# 2. Create New OAuth App
# 3. Set authorization callback URL: http://localhost:8000/auth/github/callback (dev)
#                                     https://your-domain.com/auth/github/callback (prod)
GITHUB_CLIENT_ID=your-github-client-id
GITHUB_CLIENT_SECRET=your-github-client-secret
GITHUB_REDIRECT_URI=http://localhost:8000/auth/github/callback

# Rate Limiting Configuration
# Requests per hour per user tier
RATE_LIMIT_FREE_TIER=100
RATE_LIMIT_PREMIUM_TIER=1000
RATE_LIMIT_ADMIN_TIER=10000

# Testing Mode (Development Only)
# WARNING: Never enable TEST_MODE in production!
# When enabled, bypasses authentication for all endpoints
TEST_MODE=false

# ============================================================================
# REDIS CONFIGURATION (Required for Phase 17)
# ============================================================================

# Phase 12.5: Event-Driven Architecture Configuration
# Phase 17: Also used for token revocation and rate limiting
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_CACHE_DB=0
CELERY_BROKER_URL=redis://localhost:6379/0
CELERY_RESULT_BACKEND=redis://localhost:6379/1

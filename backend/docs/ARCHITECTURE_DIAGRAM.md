# Neo Alexandria 2.0 - Complete Architecture Diagram

> **Visual System Architecture organized by Development Phases**
> 
> This document provides comprehensive ASCII diagrams showing class hierarchies, 
> relationships, and data flows for the entire Neo Alexandria 2.0 system.

---

## ğŸ“‹ Table of Contents

1. [Phase 1-3: Foundation & Core Services](#phase-1-3-foundation--core-services)
2. [Phase 4: Advanced Search](#phase-4-advanced-search)
3. [Phase 5-7: ML Classification & Active Learning](#phase-5-7-ml-classification--active-learning)
4. [Phase 8: Three-Way Hybrid Search](#phase-8-three-way-hybrid-search)
5. [Phase 9: Quality Assessment](#phase-9-quality-assessment)
6. [Phase 10: Graph-Based Recommendations](#phase-10-graph-based-recommendations)
7. [Phase 11: Domain-Driven Design Refactoring](#phase-11-domain-driven-design-refactoring)
8. [Phase 12: Fowler Refactoring Framework](#phase-12-fowler-refactoring-framework)
9. [Complete System Overview](#complete-system-overview)

---

## Phase 1-3: Foundation & Core Services

### System Foundation Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         APPLICATION FOUNDATION                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚   FastAPI App    â”‚      â”‚   Configuration  â”‚      â”‚   Database    â”‚  â”‚
â”‚  â”‚   (main.py)      â”‚â—„â”€â”€â”€â”€â”€â”¤   (settings.py)  â”‚      â”‚   (base.py)   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚           â”‚                                                  â”‚          â”‚
â”‚           â”‚                                                  â”‚          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                      Router Layer                               â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚    â”‚
â”‚  â”‚  â”‚Resources â”‚  â”‚Taxonomy  â”‚  â”‚Collectionsâ”‚ â”‚Annotationsâ”‚        â”‚    â”‚
â”‚  â”‚  â”‚  Router  â”‚  â”‚  Router  â”‚  â”‚  Router   â”‚ â”‚  Router   â”‚        â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜         â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚          â”‚             â”‚             â”‚             â”‚                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                      Service Layer                              â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚    â”‚
â”‚  â”‚  â”‚  Resource    â”‚  â”‚  Taxonomy    â”‚  â”‚  Collection  â”‚           â”‚    â”‚
â”‚  â”‚  â”‚  Service     â”‚  â”‚  Service     â”‚  â”‚  Service     â”‚           â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚            â”‚                  â”‚                  â”‚                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                      Database Models (SQLAlchemy)               â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚    â”‚
â”‚  â”‚  â”‚ Resource â”‚  â”‚Taxonomy  â”‚  â”‚Collectionâ”‚  â”‚Annotationâ”‚         â”‚    â”‚
â”‚  â”‚  â”‚  Model   â”‚  â”‚  Node    â”‚  â”‚  Model   â”‚  â”‚  Model   â”‚         â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Database Model Hierarchy

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   SQLAlchemy Base   â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚                â”‚                â”‚                â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚    Resource      â”‚  â”‚ TaxonomyNode â”‚  â”‚ Collection â”‚  â”‚ Annotation â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚ â€¢ id: UUID       â”‚  â”‚ â€¢ id: UUID   â”‚  â”‚ â€¢ id: UUID â”‚  â”‚ â€¢ id: UUID â”‚
    â”‚ â€¢ title: str     â”‚  â”‚ â€¢ code: str  â”‚  â”‚ â€¢ name     â”‚  â”‚ â€¢ content  â”‚
    â”‚ â€¢ description    â”‚  â”‚ â€¢ name: str  â”‚  â”‚ â€¢ owner_id â”‚  â”‚ â€¢ user_id  â”‚
    â”‚ â€¢ creator        â”‚  â”‚ â€¢ parent_id  â”‚  â”‚ â€¢ public   â”‚  â”‚ â€¢ type     â”‚
    â”‚ â€¢ subject: JSON  â”‚  â”‚ â€¢ level: int â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚ â€¢ type           â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚ â€¢ language       â”‚         â”‚
    â”‚ â€¢ identifier     â”‚         â”‚ self-referential
    â”‚ â€¢ doi            â”‚         â–¼
    â”‚ â€¢ embedding      â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ â€¢ created_at     â”‚  â”‚   children   â”‚
    â”‚ â€¢ updated_at     â”‚  â”‚  (List[Node])â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â”‚ one-to-many
            â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ ResourceTaxonomy â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚ â€¢ resource_id    â”‚
    â”‚ â€¢ taxonomy_id    â”‚
    â”‚ â€¢ confidence     â”‚
    â”‚ â€¢ method         â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Phase 4: Advanced Search

### Search Architecture Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        PHASE 4: ADVANCED SEARCH                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                       â”‚
â”‚  User Query: "machine learning algorithms"                            â”‚
â”‚       â”‚                                                               â”‚
â”‚       â–¼                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚              Search Router (POST /api/search/hybrid)            â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                               â”‚                                       â”‚
â”‚                               â–¼                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                  AdvancedSearchService                        â”‚    â”‚
â”‚  â”‚                                                               â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚    â”‚
â”‚  â”‚  â”‚   FTS5 Search        â”‚        â”‚   Vector Search      â”‚     â”‚    â”‚
â”‚  â”‚  â”‚   (Keyword-based)    â”‚        â”‚   (Semantic)         â”‚     â”‚    â”‚
â”‚  â”‚  â”‚                      â”‚        â”‚                      â”‚     â”‚    â”‚
â”‚  â”‚  â”‚ â€¢ Parse query        â”‚        â”‚ â€¢ Generate embedding â”‚     â”‚    â”‚
â”‚  â”‚  â”‚ â€¢ FTS5 match         â”‚        â”‚ â€¢ Cosine similarity  â”‚     â”‚    â”‚
â”‚  â”‚  â”‚ â€¢ BM25 scoring       â”‚        â”‚ â€¢ Top-k results      â”‚     â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚    â”‚
â”‚  â”‚             â”‚                               â”‚                 â”‚    â”‚
â”‚  â”‚             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚    â”‚
â”‚  â”‚                         â–¼                                     â”‚    â”‚
â”‚  â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                         â”‚    â”‚
â”‚  â”‚              â”‚  Hybrid Fusion       â”‚                         â”‚    â”‚
â”‚  â”‚              â”‚  (Weighted Combine)  â”‚                         â”‚    â”‚
â”‚  â”‚              â”‚                      â”‚                         â”‚    â”‚
â”‚  â”‚              â”‚  score = Î±Â·fts +     â”‚                         â”‚    â”‚
â”‚  â”‚              â”‚          Î²Â·vector    â”‚                         â”‚    â”‚
â”‚  â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                         â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                             â”‚                                         â”‚
â”‚                             â–¼                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                    Search Results                               â”‚  â”‚
â”‚  â”‚  â€¢ Ranked resources                                             â”‚  â”‚
â”‚  â”‚  â€¢ Facets (type, language, year)                                â”‚  â”‚
â”‚  â”‚  â€¢ Snippets with highlights                                     â”‚  â”‚
â”‚  â”‚  â€¢ Total count                                                  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Search Service Class Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   AdvancedSearchService                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Public Methods:                                                â”‚
â”‚  â€¢ hybrid_search(db, query, weight) â†’ (resources, total, ...)  â”‚
â”‚  â€¢ fts_search(db, query, filters, ...) â†’ (resources, ...)      â”‚
â”‚  â€¢ vector_search(db, query_text, ...) â†’ (resources, ...)       â”‚
â”‚  â€¢ parse_search_query(query: str) â†’ str                        â”‚
â”‚  â€¢ generate_snippets(text, query, max_len) â†’ str           bb  â”‚
â”‚                                                                â”‚
â”‚ Private Methods:                                               â”‚
â”‚  â€¢ _analyze_query(query) â†’ Dict[str, Any]                      â”‚
â”‚  â€¢ _search_sparse(db, query_text, limit) â†’ List[Tuple]         â”‚
â”‚  â€¢ _fetch_resources_ordered(db, ids, filters) â†’ List[Res]      â”‚
â”‚  â€¢ _compute_facets(db, query) â†’ Facets                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Dependencies:                                                  â”‚
â”‚  â€¢ Database Session                                            â”‚
â”‚  â€¢ AI Core (embeddings)                                        â”‚
â”‚  â€¢ FTS5 (SQLite full-text search)                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Phase 5-7: ML Classification & Active Learning

### ML Classification Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              PHASE 5-7: ML CLASSIFICATION & ACTIVE LEARNING             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚  Input Text: "Deep learning for natural language processing"            â”‚
â”‚       â”‚                                                                 â”‚
â”‚       â–¼                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚         Classification Router (POST /api/classification)        â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                â”‚                                        â”‚
â”‚                                â–¼                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                  MLClassificationService                        â”‚    â”‚
â”‚  â”‚                                                                 â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚    â”‚
â”‚  â”‚  â”‚              Model Loading (Lazy)                        â”‚   â”‚    â”‚
â”‚  â”‚  â”‚  â€¢ Check if model loaded                                 â”‚   â”‚    â”‚
â”‚  â”‚  â”‚  â€¢ Load DistilBERT/BERT from checkpoint                  â”‚   â”‚    â”‚
â”‚  â”‚  â”‚  â€¢ Move to GPU if available                              â”‚   â”‚    â”‚
â”‚  â”‚  â”‚  â€¢ Load label mappings                                   â”‚   â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚    â”‚
â”‚  â”‚                         â”‚                                       â”‚    â”‚
â”‚  â”‚                         â–¼                                       â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚    â”‚
â”‚  â”‚  â”‚              Inference Pipeline                          â”‚   â”‚    â”‚
â”‚  â”‚  â”‚                                                          â”‚   â”‚    â”‚
â”‚  â”‚  â”‚  1. Tokenize input (max 512 tokens)                      â”‚   â”‚    â”‚
â”‚  â”‚  â”‚  2. Forward pass through model                           â”‚   â”‚    â”‚
â”‚  â”‚  â”‚  3. Apply sigmoid activation                             â”‚   â”‚    â”‚
â”‚  â”‚  â”‚  4. Sort by confidence                                   â”‚   â”‚    â”‚
â”‚  â”‚  â”‚  5. Take top-k predictions                               â”‚   â”‚    â”‚
â”‚  â”‚  â”‚  6. Create ClassificationResult                          â”‚   â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚    â”‚
â”‚  â”‚                         â”‚                                       â”‚    â”‚
â”‚  â”‚                         â–¼                                       â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚    â”‚
â”‚  â”‚  â”‚           Active Learning (Optional)                     â”‚   â”‚    â”‚
â”‚  â”‚  â”‚                                                          â”‚   â”‚    â”‚
â”‚  â”‚  â”‚  â€¢ Uncertainty sampling                                  â”‚   â”‚    â”‚
â”‚  â”‚  â”‚  â€¢ Identify low-confidence predictions                   â”‚   â”‚    â”‚
â”‚  â”‚  â”‚  â€¢ Request human labels                                  â”‚   â”‚    â”‚
â”‚  â”‚  â”‚  â€¢ Retrain with new data                                 â”‚   â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                â”‚                                        â”‚
â”‚                                â–¼                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚              PredictionMonitor (Observability)                  â”‚    â”‚
â”‚  â”‚  â€¢ Log predictions                                              â”‚    â”‚ 
â”‚  â”‚  â€¢ Track confidence distribution                                â”‚    â”‚
â”‚  â”‚  â€¢ Monitor latency                                              â”‚    â”‚
â”‚  â”‚  â€¢ Detect drift                                                 â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ML Classification Class Hierarchy

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    MLClassificationService                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Attributes:                                                        â”‚
â”‚  â€¢ db: Session                                                     â”‚
â”‚  â€¢ model_name: str = "distilbert-base-uncased"                     â”‚
â”‚  â€¢ model: Optional[AutoModelForSequenceClassification]             â”‚
â”‚  â€¢ tokenizer: Optional[AutoTokenizer]                              â”‚
â”‚  â€¢ id_to_label: Dict[int, str]                                     â”‚
â”‚  â€¢ label_to_id: Dict[str, int]                                     â”‚
â”‚  â€¢ monitor: PredictionMonitor                                      â”‚
â”‚  â€¢ checkpoint_dir: Path                                            â”‚
â”‚  â€¢ device: torch.device                                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Public Methods:                                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Training & Fine-tuning                                       â”‚  â”‚ 
â”‚  â”‚  â€¢ fine_tune(labeled_data, ...) â†’ Dict[str, float]           â”‚  â”‚
â”‚  â”‚  â€¢ semi_supervised_learning(...) â†’ Dict[str, float]          â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ 
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Inference                                                    â”‚  â”‚
â”‚  â”‚  â€¢ predict(text, top_k) â†’ ClassificationResult               â”‚  â”‚
â”‚  â”‚  â€¢ predict_batch(texts, top_k) â†’ List[ClassificationResult]  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Active Learning                                              â”‚  â”‚
â”‚  â”‚  â€¢ active_learning_uncertainty_sampling(...)                 â”‚  â”‚
â”‚  â”‚  â€¢ get_model_metrics(window_minutes) â†’ Dict                  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Private Methods (20+ helper methods):                              â”‚
â”‚  â€¢ _load_model(), _import_ml_libraries()                           â”‚
â”‚  â€¢ _tokenize_texts(), _create_datasets()                           â”‚
â”‚  â€¢ _compute_metrics(), _calculate_classification_metrics()         â”‚
â”‚  â€¢ _build_label_mapping(), _convert_to_multihot_encoding()         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Phase 8: Three-Way Hybrid Search

### Three-Way Hybrid Search Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  PHASE 8: THREE-WAY HYBRID SEARCH                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                        â”‚
â”‚  Query: "quantum computing applications"                               â”‚
â”‚       â”‚                                                                â”‚
â”‚       â–¼                                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚              HybridSearchQuery.execute()                        â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                â”‚                                       â”‚
â”‚       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚       â”‚                        â”‚                        â”‚              â”‚
â”‚       â–¼                        â–¼                        â–¼              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚  â”‚  FTS5   â”‚            â”‚  Dense  â”‚            â”‚ Sparse  â”‚             â”‚
â”‚  â”‚ Search  â”‚            â”‚ Vector  â”‚            â”‚ Vector  â”‚             â”‚
â”‚  â”‚         â”‚            â”‚ Search  â”‚            â”‚ Search  â”‚             â”‚
â”‚  â”‚ â€¢ BM25  â”‚            â”‚ â€¢ BERT  â”‚            â”‚ â€¢ SPLADEâ”‚             â”‚
â”‚  â”‚ â€¢ Match â”‚            â”‚ â€¢ Cosineâ”‚            â”‚ â€¢ TF-IDFâ”‚             â”‚
â”‚  â”‚ â€¢ Score â”‚            â”‚ â€¢ Top-K â”‚            â”‚ â€¢ Top-K â”‚             â”‚
â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜             â”‚
â”‚       â”‚                      â”‚                      â”‚                  â”‚
â”‚       â”‚  Results: 100        â”‚  Results: 100        â”‚  Results: 100    â”‚
â”‚       â”‚                      â”‚                      â”‚                  â”‚
â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
â”‚                              â”‚                                         â”‚
â”‚                              â–¼                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚           PHASE 2: Reciprocal Rank Fusion (RRF)                 â”‚   â”‚
â”‚  â”‚                                                                 â”‚   â”‚
â”‚  â”‚  For each document d:                                           â”‚   â”‚
â”‚  â”‚    RRF(d) = Î£ [weight_i / (k + rank_i(d))]                      â”‚   â”‚
â”‚  â”‚                                                                 â”‚   â”‚
â”‚  â”‚  Adaptive Weights:                                              â”‚   â”‚
â”‚  â”‚    â€¢ Short query â†’ Higher FTS5 weight                           â”‚   â”‚
â”‚  â”‚    â€¢ Long query â†’ Higher dense vector weight                    â”‚   â”‚
â”‚  â”‚    â€¢ Technical terms â†’ Higher sparse weight                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                               â”‚                                        â”‚
â”‚                               â–¼                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚           PHASE 3: ColBERT Reranking (Optional)                 â”‚   â”‚
â”‚  â”‚                                                                 â”‚   â”‚
â”‚  â”‚  â€¢ Take top 100 candidates                                      â”‚   â”‚
â”‚  â”‚  â€¢ Apply ColBERT cross-encoder                                  â”‚   â”‚
â”‚  â”‚  â€¢ Rerank by relevance score                                    â”‚   â”‚
â”‚  â”‚  â€¢ Timeout: 1 second                                            â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                               â”‚                                        â”‚
â”‚                               â–¼                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                    Final Ranked Results                         â”‚   â”‚
â”‚  â”‚  â€¢ Paginated resources                                          â”‚   â”‚
â”‚  â”‚  â€¢ Facets                                                       â”‚   â”‚
â”‚  â”‚  â€¢ Snippets                                                     â”‚   â”‚
â”‚  â”‚  â€¢ Metadata (latency, method contributions, weights)            â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Search Pipeline Data Structures

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   RetrievalCandidates                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Attributes:                                                    â”‚
â”‚  â€¢ fts5_results: List[Tuple[str, float]]                       â”‚
â”‚  â€¢ dense_results: List[Tuple[str, float]]                      â”‚
â”‚  â€¢ sparse_results: List[Tuple[str, float]]                     â”‚
â”‚  â€¢ retrieval_time_ms: float                                    â”‚
â”‚  â€¢ method_times_ms: Dict[str, float]                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Methods:                                                       â”‚
â”‚  â€¢ get_all_candidate_ids() â†’ set[str]                          â”‚
â”‚  â€¢ get_method_counts() â†’ Dict[str, int]                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â”‚ feeds into
                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     FusedCandidates                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Attributes:                                                    â”‚
â”‚  â€¢ fused_results: List[Tuple[str, float]]                      â”‚
â”‚  â€¢ weights_used: List[float]                                   â”‚
â”‚  â€¢ fusion_time_ms: float                                       â”‚
â”‚  â€¢ method_contributions: Dict[str, int]                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Methods:                                                       â”‚
â”‚  â€¢ get_top_k(k: int) â†’ List[Tuple[str, float]]                 â”‚
â”‚  â€¢ get_candidate_ids() â†’ List[str]                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Phase 9: Quality Assessment

### Quality Assessment Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    PHASE 9: QUALITY ASSESSMENT                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                        â”‚
â”‚  Resource ID: "abc-123"                                                â”‚
â”‚       â”‚                                                                â”‚
â”‚       â–¼                                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚         Quality Router (POST /api/quality/compute/{id})         â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                               â”‚                                        â”‚
â”‚                               â–¼                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                    QualityService                              â”‚    â”‚
â”‚  â”‚                                                                â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚    â”‚
â”‚  â”‚  â”‚         Compute 5 Quality Dimensions                     â”‚  â”‚    â”‚
â”‚  â”‚  â”‚                                                          â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  Weight: 0.30                        â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚   Accuracy     â”‚  â€¢ Data validation                   â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚   Score: 0.7   â”‚  â€¢ Cross-references                  â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â€¢ Citation accuracy                 â”‚  â”‚    â”‚
â”‚  â”‚  â”‚                                                          â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  Weight: 0.25                        â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚ Completeness   â”‚  â€¢ Required fields present           â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚   Score: 0.8   â”‚  â€¢ Metadata richness                 â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â€¢ Description quality               â”‚  â”‚    â”‚
â”‚  â”‚  â”‚                                                          â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  Weight: 0.20                        â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  Consistency   â”‚  â€¢ Format consistency                â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚   Score: 0.75  â”‚  â€¢ Naming conventions                â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â€¢ No contradictions                 â”‚  â”‚    â”‚
â”‚  â”‚  â”‚                                                          â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  Weight: 0.15                        â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  Timeliness    â”‚  â€¢ Publication date                  â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚   Score: 0.7   â”‚  â€¢ Last update time                  â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â€¢ Currency relevance                â”‚  â”‚    â”‚
â”‚  â”‚  â”‚                                                          â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  Weight: 0.15                        â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚   Relevance    â”‚  â€¢ Topic relevance                   â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚   Score: 0.7   â”‚  â€¢ User context                      â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â€¢ Search matching                   â”‚  â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚    â”‚
â”‚  â”‚                         â”‚                                      â”‚    â”‚
â”‚  â”‚                         â–¼                                      â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚    â”‚
â”‚  â”‚  â”‚           Calculate Overall Score                        â”‚  â”‚    â”‚
â”‚  â”‚  â”‚                                                          â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  overall = 0.30Ã—accuracy + 0.25Ã—completeness +           â”‚  â”‚    â”‚
â”‚  â”‚  â”‚            0.20Ã—consistency + 0.15Ã—timeliness +          â”‚  â”‚    â”‚
â”‚  â”‚  â”‚            0.15Ã—relevance                                â”‚  â”‚    â”‚
â”‚  â”‚  â”‚                                                          â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  overall = 0.735 â†’ "HIGH QUALITY"                        â”‚  â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                â”‚                                       â”‚
â”‚                                â–¼                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚              Additional Quality Features                        â”‚   â”‚
â”‚  â”‚                                                                 â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚   â”‚
â”‚  â”‚  â”‚ Outlier Detection    â”‚  â”‚ Degradation Monitor  â”‚             â”‚   â”‚
â”‚  â”‚  â”‚ (Isolation Forest)   â”‚  â”‚ (Time-based)         â”‚             â”‚   â”‚
â”‚  â”‚  â”‚                      â”‚  â”‚                      â”‚             â”‚   â”‚
â”‚  â”‚  â”‚ â€¢ 9-dim features     â”‚  â”‚ â€¢ Compare old/new    â”‚             â”‚   â”‚
â”‚  â”‚  â”‚ â€¢ Anomaly scoring    â”‚  â”‚ â€¢ Flag >20% drop     â”‚             â”‚   â”‚
â”‚  â”‚  â”‚ â€¢ Flag for review    â”‚  â”‚ â€¢ Trigger review     â”‚             â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Quality Service Class Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      QualityService                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Attributes:                                                    â”‚
â”‚  â€¢ db: Session                                                 â”‚
â”‚  â€¢ quality_version: str = "v2.0"                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Public Methods:                                                â”‚
â”‚  â€¢ compute_quality(resource_id, weights) â†’ QualityScore        â”‚
â”‚  â€¢ monitor_quality_degradation(days) â†’ List[Dict]              â”‚
â”‚  â€¢ detect_quality_outliers(batch_size) â†’ int                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Private Methods:                                               â”‚
â”‚  â€¢ _compute_accuracy_dimension(resource) â†’ float               â”‚
â”‚  â€¢ _compute_completeness_dimension(resource) â†’ float           â”‚
â”‚  â€¢ _compute_consistency_dimension(resource) â†’ float            â”‚
â”‚  â€¢ _compute_timeliness_dimension(resource) â†’ float             â”‚
â”‚  â€¢ _compute_relevance_dimension(resource) â†’ float              â”‚
â”‚  â€¢ _update_resource_quality_fields(resource, ...) â†’ None       â”‚
â”‚  â€¢ _identify_outlier_reasons(resource) â†’ List[str]             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â”‚ uses
                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 ContentQualityAnalyzer                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Methods:                                                       â”‚
â”‚  â€¢ metadata_completeness(resource) â†’ float                     â”‚
â”‚  â€¢ text_readability(text) â†’ Dict[str, float]                   â”‚
â”‚  â€¢ overall_quality(resource, text) â†’ float                     â”‚
â”‚  â€¢ quality_level(score) â†’ str                                  â”‚
â”‚  â€¢ source_credibility(source) â†’ float                          â”‚
â”‚  â€¢ content_depth(text) â†’ float                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Phase 10: Graph-Based Recommendations

### Recommendation System Architecture (Strategy Pattern)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              PHASE 10: GRAPH-BASED RECOMMENDATIONS                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚  User ID: "user-123"                                                    â”‚
â”‚       â”‚                                                                 â”‚
â”‚       â–¼                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚    Recommendation Router (GET /api/recommendations/user/{id})   â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                               â”‚                                         â”‚
â”‚                               â–¼                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚          RecommendationStrategyFactory.create(type, db)         â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                               â”‚                                         â”‚
â”‚       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚       â”‚                       â”‚                        â”‚                â”‚
â”‚       â–¼                       â–¼                        â–¼                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚  â”‚Collabora-â”‚          â”‚ Content  â”‚           â”‚  Graph   â”‚              â”‚
â”‚  â”‚  tive    â”‚          â”‚  Based   â”‚           â”‚  Based   â”‚              â”‚
â”‚  â”‚Filtering â”‚          â”‚ Strategy â”‚           â”‚ Strategy â”‚              â”‚
â”‚  â”‚ Strategy â”‚          â”‚          â”‚           â”‚          â”‚              â”‚
â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜           â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜              â”‚
â”‚       â”‚                     â”‚                      â”‚                    â”‚
â”‚       â–¼                     â–¼                      â–¼                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚User-Item â”‚          â”‚Embedding â”‚          â”‚Citation  â”‚               â”‚
â”‚  â”‚ Matrix   â”‚          â”‚Similarityâ”‚          â”‚ Network  â”‚               â”‚
â”‚  â”‚          â”‚          â”‚          â”‚          â”‚Traversal â”‚               â”‚
â”‚  â”‚â€¢ Build   â”‚          â”‚â€¢ Profile â”‚          â”‚          â”‚               â”‚
â”‚  â”‚  matrix  â”‚          â”‚  vector  â”‚          â”‚â€¢ BFS/DFS â”‚               â”‚
â”‚  â”‚â€¢ Compute â”‚          â”‚â€¢ Cosine  â”‚          â”‚â€¢ Score   â”‚               â”‚
â”‚  â”‚  similar â”‚          â”‚  sim     â”‚          â”‚  by dist â”‚               â”‚
â”‚  â”‚  users   â”‚          â”‚â€¢ Rank    â”‚          â”‚â€¢ Weight  â”‚               â”‚
â”‚  â”‚â€¢ Predict â”‚          â”‚  items   â”‚          â”‚  edges   â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜               â”‚
â”‚       â”‚                     â”‚                     â”‚                     â”‚
â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚
â”‚                             â”‚                                           â”‚
â”‚                             â–¼                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                    HybridStrategy                               â”‚    â”‚
â”‚  â”‚                                                                 â”‚    â”‚
â”‚  â”‚  â€¢ Combine results from all strategies                          â”‚    â”‚
â”‚  â”‚  â€¢ Apply weighted fusion                                        â”‚    â”‚
â”‚  â”‚  â€¢ Deduplicate recommendations                                  â”‚    â”‚
â”‚  â”‚  â€¢ Rank by combined score                                       â”‚    â”‚
â”‚  â”‚                                                                 â”‚    â”‚ 
â”‚  â”‚  final_score = w1Â·collab + w2Â·content + w3Â·graph                â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                               â”‚                                         â”‚
â”‚                               â–¼                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚              List[Recommendation] (Domain Objects)              â”‚    â”‚
â”‚  â”‚                                                                 â”‚    â”‚
â”‚  â”‚  Each Recommendation contains:                                  â”‚    â”‚
â”‚  â”‚   â€¢ resource_id: str                                            â”‚    â”‚
â”‚  â”‚   â€¢ user_id: str                                                â”‚    â”‚ 
â”‚  â”‚   â€¢ recommendation_score: RecommendationScore                   â”‚    â”‚ 
â”‚  â”‚   â€¢ strategy: str                                               â”‚    â”‚
â”‚  â”‚   â€¢ reason: Optional[str]                                       â”‚    â”‚
â”‚  â”‚   â€¢ metadata: Dict[str, Any]                                    â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Strategy Pattern Class Hierarchy

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  RecommendationStrategy      â”‚
                    â”‚  (Abstract Base Class)       â”‚
                    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                    â”‚ + generate(user_id, limit)   â”‚
                    â”‚   â†’ List[Recommendation]     â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â”‚
                                   â”‚ implements
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚                    â”‚                    â”‚                â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”
    â”‚ Collaborative      â”‚  â”‚  Content      â”‚    â”‚   Graph       â”‚   â”‚  Hybrid  â”‚
    â”‚ FilteringStrategy  â”‚  â”‚  BasedStrategyâ”‚    â”‚BasedStrategy  â”‚   â”‚ Strategy â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚â€¢ db: Session       â”‚  â”‚â€¢ db: Session  â”‚    â”‚â€¢ db: Session  â”‚   â”‚â€¢ strats  â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚â€¢ weights â”‚
    â”‚+ generate()        â”‚  â”‚+ generate()   â”‚    â”‚+ generate()   â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚- _build_matrix()   â”‚  â”‚- _build_prof()â”‚    â”‚- _traverse()  â”‚   â”‚+ generateâ”‚
    â”‚- _find_similar()   â”‚  â”‚- _compute_sim â”‚    â”‚- _score_path()â”‚   â”‚- _merge()â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Citation Graph Structure

```
                    Resource A
                    (Paper on ML)
                         â”‚
                         â”‚ cites
                         â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                                  â”‚
   Resource B                         Resource C
   (Deep Learning)                    (Neural Nets)
        â”‚                                  â”‚
        â”‚ cites                            â”‚ cites
        â–¼                                  â–¼
   Resource D â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€Resource E
   (CNNs)                            (RNNs)
        â”‚
        â”‚ cited by
        â–¼
   Resource F
   (Computer Vision)

Graph Traversal for Recommendations:
â€¢ Start from user's interacted resources
â€¢ BFS/DFS through citation network
â€¢ Score by: distance, citation count, recency
â€¢ Weight edges by citation context
```

---

## Phase 11: Domain-Driven Design Refactoring

### Domain Layer Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            PHASE 11: DOMAIN-DRIVEN DESIGN (DDD) REFACTORING             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                          â”‚
â”‚                   â”‚  BaseDomainObject (ABC)  â”‚                          â”‚
â”‚                   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                          â”‚
â”‚                   â”‚ + to_dict()              â”‚                          â”‚
â”‚                   â”‚ + from_dict()            â”‚                          â”‚
â”‚                   â”‚ + to_json()              â”‚                          â”‚
â”‚                   â”‚ + from_json()            â”‚                          â”‚
â”‚                   â”‚ + validate() [abstract]  â”‚                          â”‚
â”‚                   â”‚ + __eq__()               â”‚                          â”‚
â”‚                   â”‚ + __repr__()             â”‚                          â”‚
â”‚                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                          â”‚
                             â”‚                                            â”‚
â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                             â”‚
â”‚              â”‚                            â”‚                             â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
â”‚    â”‚   ValueObject      â”‚      â”‚   DomainEntity      â”‚                  â”‚
â”‚    â”‚   (dataclass)      â”‚      â”‚                     â”‚                  â”‚
â”‚    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤      â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                  â”‚
â”‚    â”‚ Immutable          â”‚      â”‚ â€¢ entity_id: str    â”‚                  â”‚
â”‚    â”‚ Defined by values  â”‚      â”‚ Identity-based      â”‚                  â”‚
â”‚    â”‚ No identity        â”‚      â”‚ Mutable             â”‚                  â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
â”‚              â”‚                                                          â”‚
â”‚              â”‚ subclasses                                               â”‚
â”‚              â”‚                                                          â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚    â”‚         â”‚         â”‚             â”‚             â”‚             â”‚      â”‚
â”‚    â–¼         â–¼         â–¼             â–¼             â–¼             â–¼      â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚ â”‚Class-â”‚ â”‚Class-â”‚ â”‚ Quality  â”‚ â”‚Recommend-â”‚ â”‚ Search   â”‚ â”‚ Search   â”‚   â”‚
â”‚ â”‚ifica-â”‚ â”‚ifica-â”‚ â”‚  Score   â”‚ â”‚  ation   â”‚ â”‚  Query   â”‚ â”‚ Result   â”‚   â”‚
â”‚ â”‚tion  â”‚ â”‚tion  â”‚ â”‚          â”‚ â”‚  Score   â”‚ â”‚          â”‚ â”‚          â”‚   â”‚
â”‚ â”‚Predicâ”‚ â”‚Resultâ”‚ â”‚          â”‚ â”‚          â”‚ â”‚          â”‚ â”‚          â”‚   â”‚
â”‚ â”‚tion  â”‚ â”‚      â”‚ â”‚          â”‚ â”‚          â”‚ â”‚          â”‚ â”‚          â”‚   â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Domain Objects Detailed View

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    CLASSIFICATION DOMAIN                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚         ClassificationPrediction (ValueObject)               â”‚      â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤      â”‚
â”‚  â”‚ Attributes:                                                  â”‚      â”‚
â”‚  â”‚  â€¢ taxonomy_id: str                                          â”‚      â”‚
â”‚  â”‚  â€¢ confidence: float (0.0-1.0)                               â”‚      â”‚
â”‚  â”‚  â€¢ rank: int (1-based)                                       â”‚      â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤      â”‚
â”‚  â”‚ Methods:                                                     â”‚      â”‚
â”‚  â”‚  â€¢ validate()                                                â”‚      â”‚
â”‚  â”‚  â€¢ is_high_confidence(threshold=0.8) â†’ bool                  â”‚      â”‚
â”‚  â”‚  â€¢ is_low_confidence(threshold=0.5) â†’ bool                   â”‚      â”‚
â”‚  â”‚  â€¢ is_medium_confidence(low, high) â†’ bool                    â”‚      â”‚ 
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                             â”‚                                          â”‚
â”‚                             â”‚ contains multiple                        â”‚
â”‚                             â–¼                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚         ClassificationResult (ValueObject)                   â”‚      â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤      â”‚
â”‚  â”‚ Attributes:                                                  â”‚      â”‚
â”‚  â”‚  â€¢ predictions: List[ClassificationPrediction]               â”‚      â”‚
â”‚  â”‚  â€¢ model_version: str                                        â”‚      â”‚
â”‚  â”‚  â€¢ inference_time_ms: float                                  â”‚      â”‚
â”‚  â”‚  â€¢ resource_id: Optional[str]                                â”‚      â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤      â”‚
â”‚  â”‚ Methods:                                                     â”‚      â”‚
â”‚  â”‚  â€¢ validate()                                                â”‚      â”‚
â”‚  â”‚  â€¢ get_high_confidence(threshold) â†’ List[Prediction]         â”‚      â”‚
â”‚  â”‚  â€¢ get_top_k(k) â†’ List[Prediction]                           â”‚      â”‚
â”‚  â”‚  â€¢ get_best_prediction() â†’ Prediction                        â”‚      â”‚
â”‚  â”‚  â€¢ count_by_confidence_level() â†’ Dict[str, int]              â”‚      â”‚
â”‚  â”‚  â€¢ to_dict() â†’ Dict[str, Any]                                â”‚      â”‚
â”‚  â”‚  â€¢ from_dict(data) â†’ ClassificationResult                    â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                                                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       QUALITY DOMAIN                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚              QualityScore (ValueObject)                      â”‚      â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤      â”‚
â”‚  â”‚ Attributes (5 Dimensions):                                   â”‚      â”‚
â”‚  â”‚  â€¢ accuracy: float (0.0-1.0)        Weight: 0.30             â”‚      â”‚
â”‚  â”‚  â€¢ completeness: float (0.0-1.0)    Weight: 0.25             â”‚      â”‚
â”‚  â”‚  â€¢ consistency: float (0.0-1.0)     Weight: 0.20             â”‚      â”‚
â”‚  â”‚  â€¢ timeliness: float (0.0-1.0)      Weight: 0.15             â”‚      â”‚
â”‚  â”‚  â€¢ relevance: float (0.0-1.0)       Weight: 0.15             â”‚      â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤      â”‚
â”‚  â”‚ Methods:                                                     â”‚      â”‚
â”‚  â”‚  â€¢ validate()                                                â”‚      â”‚
â”‚  â”‚  â€¢ overall_score() â†’ float                                   â”‚      â”‚
â”‚  â”‚  â€¢ is_high_quality(threshold=0.7) â†’ bool                     â”‚      â”‚
â”‚  â”‚  â€¢ is_low_quality(threshold=0.5) â†’ bool                      â”‚      â”‚
â”‚  â”‚  â€¢ get_quality_level() â†’ str ("high"/"medium"/"low")         â”‚      â”‚
â”‚  â”‚  â€¢ get_weakest_dimension() â†’ str                             â”‚      â”‚
â”‚  â”‚  â€¢ get_strongest_dimension() â†’ str                           â”‚      â”‚
â”‚  â”‚  â€¢ get_dimension_scores() â†’ Dict[str, float]                 â”‚      â”‚
â”‚  â”‚  â€¢ has_dimension_below_threshold(t) â†’ bool                   â”‚      â”‚
â”‚  â”‚  â€¢ count_dimensions_below_threshold(t) â†’ int                 â”‚      â”‚
â”‚  â”‚  â€¢ to_dict() â†’ Dict[str, Any]                                â”‚      â”‚
â”‚  â”‚  â€¢ from_dict(data) â†’ QualityScore                            â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                                                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   RECOMMENDATION DOMAIN                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚         RecommendationScore (ValueObject)                    â”‚      â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤      â”‚
â”‚  â”‚ Attributes:                                                  â”‚      â”‚
â”‚  â”‚  â€¢ score: float (0.0-1.0)                                    â”‚      â”‚
â”‚  â”‚  â€¢ confidence: float (0.0-1.0)                               â”‚      â”‚
â”‚  â”‚  â€¢ rank: int (1-based)                                       â”‚      â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤      â”‚
â”‚  â”‚ Methods:                                                     â”‚      â”‚
â”‚  â”‚  â€¢ validate()                                                â”‚      â”‚
â”‚  â”‚  â€¢ is_high_confidence(threshold=0.8) â†’ bool                  â”‚      â”‚
â”‚  â”‚  â€¢ is_high_score(threshold=0.7) â†’ bool                       â”‚      â”‚
â”‚  â”‚  â€¢ is_top_ranked(top_k=5) â†’ bool                             â”‚      â”‚
â”‚  â”‚  â€¢ combined_quality() â†’ float                                â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                             â”‚                                          â”‚
â”‚                             â”‚ embedded in                              â”‚
â”‚                             â–¼                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚              Recommendation (ValueObject)                    â”‚      â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤      â”‚
â”‚  â”‚ Attributes:                                                  â”‚      â”‚
â”‚  â”‚  â€¢ resource_id: str                                          â”‚      â”‚
â”‚  â”‚  â€¢ user_id: str                                              â”‚      â”‚
â”‚  â”‚  â€¢ recommendation_score: RecommendationScore                 â”‚      â”‚
â”‚  â”‚  â€¢ strategy: str = "unknown"                                 â”‚      â”‚
â”‚  â”‚  â€¢ reason: Optional[str]                                     â”‚      â”‚
â”‚  â”‚  â€¢ metadata: Optional[Dict[str, Any]]                        â”‚      â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤      â”‚
â”‚  â”‚ Methods:                                                     â”‚      â”‚
â”‚  â”‚  â€¢ validate()                                                â”‚      â”‚
â”‚  â”‚  â€¢ get_score() â†’ float                                       â”‚      â”‚
â”‚  â”‚  â€¢ get_confidence() â†’ float                                  â”‚      â”‚
â”‚  â”‚  â€¢ get_rank() â†’ int                                          â”‚      â”‚
â”‚  â”‚  â€¢ is_high_quality(score_t, conf_t) â†’ bool                   â”‚      â”‚
â”‚  â”‚  â€¢ is_top_recommendation(top_k=5) â†’ bool                     â”‚      â”‚
â”‚  â”‚  â€¢ get_metadata_value(key, default) â†’ Any                    â”‚      â”‚
â”‚  â”‚  â€¢ __lt__, __le__, __gt__, __ge__ (for sorting)              â”‚      â”‚
â”‚  â”‚  â€¢ to_dict() â†’ Dict[str, Any]                                â”‚      â”‚
â”‚  â”‚  â€¢ from_dict(data) â†’ Recommendation                          â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                                                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       SEARCH DOMAIN                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚              SearchQuery (ValueObject)                       â”‚      â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤      â”‚
â”‚  â”‚ Attributes:                                                  â”‚      â”‚
â”‚  â”‚  â€¢ query_text: str                                           â”‚      â”‚
â”‚  â”‚  â€¢ limit: int = 20                                           â”‚      â”‚
â”‚  â”‚  â€¢ enable_reranking: bool = True                             â”‚      â”‚
â”‚  â”‚  â€¢ adaptive_weights: bool = True                             â”‚      â”‚
â”‚  â”‚  â€¢ search_method: str = "hybrid"                             â”‚      â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤      â”‚
â”‚  â”‚ Methods:                                                     â”‚      â”‚
â”‚  â”‚  â€¢ validate()                                                â”‚      â”‚
â”‚  â”‚  â€¢ is_short_query(threshold=3) â†’ bool                        â”‚      â”‚
â”‚  â”‚  â€¢ is_long_query(threshold=10) â†’ bool                        â”‚      â”‚
â”‚  â”‚  â€¢ is_medium_query(short, long) â†’ bool                       â”‚      â”‚
â”‚  â”‚  â€¢ get_word_count() â†’ int                                    â”‚      â”‚
â”‚  â”‚  â€¢ is_single_word() â†’ bool                                   â”‚      â”‚
â”‚  â”‚  â€¢ get_query_length() â†’ int                                  â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                             â”‚                                          â”‚
â”‚                             â”‚ produces                                 â”‚
â”‚                             â–¼                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚              SearchResults (ValueObject)                     â”‚      â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤      â”‚
â”‚  â”‚ Attributes:                                                  â”‚      â”‚
â”‚  â”‚  â€¢ results: List[SearchResult]                               â”‚      â”‚
â”‚  â”‚  â€¢ query: SearchQuery                                        â”‚      â”‚
â”‚  â”‚  â€¢ total_results: int                                        â”‚      â”‚
â”‚  â”‚  â€¢ search_time_ms: float                                     â”‚      â”‚
â”‚  â”‚  â€¢ reranked: bool = False                                    â”‚      â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€


## Service Layer Architecture

The service layer implements business logic and orchestrates domain objects, database operations, and external services.

### ML Classification Service

```
MLClassificationService
â”œâ”€â”€ Attributes:
â”‚   â”œâ”€â”€ db: Session
â”‚   â”œâ”€â”€ model_name: str
â”‚   â”œâ”€â”€ model_version: Optional[str]
â”‚   â”œâ”€â”€ model: Optional[AutoModelForSequenceClassification]
â”‚   â”œâ”€â”€ tokenizer: Optional[AutoTokenizer]
â”‚   â”œâ”€â”€ id_to_label: Dict[int, str]
â”‚   â”œâ”€â”€ label_to_id: Dict[str, int]
â”‚   â”œâ”€â”€ monitor: PredictionMonitor
â”‚   â”œâ”€â”€ checkpoint_dir: Path
â”‚   â””â”€â”€ device: torch.device
â”œâ”€â”€ Constants:
â”‚   â”œâ”€â”€ DEFAULT_MODEL_NAME = "distilbert-base-uncased"
â”‚   â”œâ”€â”€ MAX_TOKEN_LENGTH = 512
â”‚   â”œâ”€â”€ DEFAULT_EPOCHS = 3
â”‚   â”œâ”€â”€ DEFAULT_BATCH_SIZE = 16
â”‚   â”œâ”€â”€ DEFAULT_LEARNING_RATE = 2e-5
â”‚   â”œâ”€â”€ BINARY_PREDICTION_THRESHOLD = 0.5
â”‚   â”œâ”€â”€ HIGH_CONFIDENCE_THRESHOLD = 0.8
â”‚   â””â”€â”€ DEFAULT_TOP_K = 5
â”œâ”€â”€ Public Methods:
â”‚   â”œâ”€â”€ __init__(db, model_name, model_version, version)
â”‚   â”œâ”€â”€ fine_tune(labeled_data, unlabeled_data, epochs, batch_size, learning_rate) -> Dict[str, float]
â”‚   â”œâ”€â”€ predict(text: str, top_k: int) -> ClassificationResult
â”‚   â”œâ”€â”€ predict_batch(texts: List[str], top_k: int) -> List[ClassificationResult]
â”‚   â”œâ”€â”€ semi_supervised_learning(labeled_data, unlabeled_data, confidence_threshold) -> Dict[str, float]
â”‚   â”œâ”€â”€ active_learning_uncertainty_sampling(unlabeled_data, limit) -> List[Tuple[str, float]]
â”‚   â””â”€â”€ get_model_metrics(window_minutes: int) -> Dict[str, Any]
â”œâ”€â”€ Private Methods:
â”‚   â”œâ”€â”€ _load_model() -> None
â”‚   â”œâ”€â”€ _import_ml_libraries() -> None
â”‚   â”œâ”€â”€ _load_tokenizer() -> None
â”‚   â”œâ”€â”€ _determine_checkpoint_path() -> Tuple[Optional[Path], Optional[str]]
â”‚   â”œâ”€â”€ _load_model_from_checkpoint(checkpoint_path, version) -> None
â”‚   â”œâ”€â”€ _try_load_checkpoint(checkpoint_path, version) -> None
â”‚   â”œâ”€â”€ _load_label_mapping(label_map_path) -> None
â”‚   â”œâ”€â”€ _load_base_model() -> None
â”‚   â”œâ”€â”€ _move_model_to_device() -> None
â”‚   â”œâ”€â”€ _compute_metrics(eval_pred) -> Dict[str, float]
â”‚   â”œâ”€â”€ _convert_logits_to_predictions(logits) -> Any
â”‚   â”œâ”€â”€ _calculate_classification_metrics(labels, predictions) -> Dict[str, float]
â”‚   â”œâ”€â”€ _build_label_mapping(labeled_data) -> int
â”‚   â”œâ”€â”€ _convert_to_multihot_encoding(labeled_data, num_labels) -> Tuple[List[str], Any]
â”‚   â”œâ”€â”€ _split_train_validation(texts, labels) -> Tuple[List[str], List[str], Any, Any]
â”‚   â”œâ”€â”€ _tokenize_texts(train_texts, val_texts) -> Tuple[Any, Any]
â”‚   â”œâ”€â”€ _create_datasets(train_encodings, val_encodings, train_labels, val_labels) -> Tuple[Any, Any]
â”‚   â”œâ”€â”€ _initialize_model_for_training(num_labels) -> None
â”‚   â”œâ”€â”€ _configure_trainer(train_dataset, val_dataset, epochs, batch_size, learning_rate) -> Trainer
â”‚   â”œâ”€â”€ _train_model(trainer) -> Dict[str, float]
â”‚   â”œâ”€â”€ _perform_semi_supervised_learning(labeled_data, unlabeled_data, eval_metrics) -> Dict[str, float]
â”‚   â”œâ”€â”€ _save_model_and_artifacts() -> None
â”‚   â””â”€â”€ _extract_metrics(eval_metrics) -> Dict[str, float]
```


### Quality Service

```
ContentQualityAnalyzer
â”œâ”€â”€ Attributes:
â”‚   â””â”€â”€ REQUIRED_KEYS: List[str] = ["title", "description", "subject", "creator", "language", "type", "identifier"]
â”œâ”€â”€ Constants:
â”‚   â”œâ”€â”€ METADATA_WEIGHT = 0.6
â”‚   â”œâ”€â”€ READABILITY_WEIGHT = 0.4
â”‚   â”œâ”€â”€ READING_EASE_MIN = 0.0
â”‚   â”œâ”€â”€ READING_EASE_MAX = 100.0
â”‚   â”œâ”€â”€ CREDIBILITY_HIGH = 0.9
â”‚   â”œâ”€â”€ CREDIBILITY_MEDIUM = 0.7
â”‚   â”œâ”€â”€ CREDIBILITY_DEFAULT = 0.6
â”‚   â”œâ”€â”€ DEPTH_THRESHOLD_MINIMAL = 100
â”‚   â”œâ”€â”€ DEPTH_THRESHOLD_SHORT = 500
â”‚   â””â”€â”€ DEPTH_THRESHOLD_MEDIUM = 2000
â”œâ”€â”€ Methods:
â”‚   â”œâ”€â”€ metadata_completeness(resource_in) -> float
â”‚   â”œâ”€â”€ text_readability(text: str) -> Dict[str, float]
â”‚   â”œâ”€â”€ overall_quality(resource_in, text) -> float
â”‚   â”œâ”€â”€ quality_level(score: float) -> str
â”‚   â”œâ”€â”€ source_credibility(source: Optional[str]) -> float
â”‚   â”œâ”€â”€ content_depth(text: Optional[str]) -> float
â”‚   â””â”€â”€ _normalize_reading_ease(reading_ease: float) -> float

QualityService
â”œâ”€â”€ Attributes:
â”‚   â”œâ”€â”€ db: Session
â”‚   â””â”€â”€ quality_version: str
â”œâ”€â”€ Constants:
â”‚   â”œâ”€â”€ HIGH_QUALITY_THRESHOLD = 0.8
â”‚   â”œâ”€â”€ MEDIUM_QUALITY_THRESHOLD = 0.5
â”‚   â”œâ”€â”€ DEFAULT_QUALITY_WEIGHTS = {...}
â”‚   â”œâ”€â”€ COMPLETENESS_FIELD_WEIGHT = 0.2
â”‚   â”œâ”€â”€ DEGRADATION_THRESHOLD = 0.2
â”‚   â”œâ”€â”€ OUTLIER_MIN_RESOURCES = 10
â”‚   â”œâ”€â”€ OUTLIER_CONTAMINATION = 0.1
â”‚   â””â”€â”€ OUTLIER_THRESHOLD_LOW = 0.3
â”œâ”€â”€ Public Methods:
â”‚   â”œâ”€â”€ __init__(db, quality_version="v2.0")
â”‚   â”œâ”€â”€ compute_quality(resource_id: str, weights: Optional[Dict]) -> QualityScore
â”‚   â”œâ”€â”€ monitor_quality_degradation(time_window_days=30) -> List[Dict[str, Any]]
â”‚   â””â”€â”€ detect_quality_outliers(batch_size=1000) -> int
â”œâ”€â”€ Private Methods:
â”‚   â”œâ”€â”€ _compute_accuracy_dimension(resource) -> float
â”‚   â”œâ”€â”€ _compute_completeness_dimension(resource) -> float
â”‚   â”œâ”€â”€ _compute_consistency_dimension(resource) -> float
â”‚   â”œâ”€â”€ _compute_timeliness_dimension(resource) -> float
â”‚   â”œâ”€â”€ _compute_relevance_dimension(resource) -> float
â”‚   â”œâ”€â”€ _compute_weighted_overall_score(accuracy, completeness, consistency, timeliness, relevance, weights) -> float
â”‚   â”œâ”€â”€ _update_resource_quality_fields(resource, accuracy, completeness, consistency, timeliness, relevance, overall, weights) -> None
â”‚   â””â”€â”€ _identify_outlier_reasons(resource) -> List[str]
```


### Recommendation Service (Strategy Pattern)

```
RecommendationService
â”œâ”€â”€ Public Functions:
â”‚   â”œâ”€â”€ get_graph_based_recommendations(db, resource_id, limit=10) -> List[Dict]
â”‚   â”œâ”€â”€ generate_recommendations_with_graph_fusion(db, resource_id, limit=10, graph_weight=0.3) -> List[Dict]
â”‚   â”œâ”€â”€ generate_recommendations(db, resource_id, limit=10, strategy="hybrid", user_id) -> List[Dict]
â”‚   â”œâ”€â”€ generate_user_profile_vector(db, user_id: str) -> List[float]
â”‚   â”œâ”€â”€ recommend_based_on_annotations(db, user_id: str, limit=10) -> List[Dict]
â”‚   â””â”€â”€ get_top_subjects(db, limit=10) -> List[str]
â”œâ”€â”€ Private Functions:
â”‚   â”œâ”€â”€ _cosine_similarity(vec1, vec2) -> float
â”‚   â”œâ”€â”€ _convert_subjects_to_vector(subjects) -> List[float]
â”‚   â””â”€â”€ _to_numpy_vector(data) -> List[float]

RecommendationStrategyFactory
â”œâ”€â”€ Methods:
â”‚   â””â”€â”€ create(strategy_type: str, db: Session) -> RecommendationStrategy

RecommendationStrategy (ABC)
â”œâ”€â”€ Methods:
â”‚   â””â”€â”€ generate(user_id: str, limit: int) -> List[Recommendation]
â”œâ”€â”€ Implementations:
â”‚   â”œâ”€â”€ CollaborativeFilteringStrategy
â”‚   â”‚   â”œâ”€â”€ Attributes:
â”‚   â”‚   â”‚   â””â”€â”€ db: Session
â”‚   â”‚   â””â”€â”€ Methods:
â”‚   â”‚       â”œâ”€â”€ generate(user_id, limit) -> List[Recommendation]
â”‚   â”‚       â””â”€â”€ _build_user_item_matrix() -> Tuple[np.ndarray, List[str], List[str]]
â”‚   â”‚
â”‚   â”œâ”€â”€ ContentBasedStrategy
â”‚   â”‚   â”œâ”€â”€ Attributes:
â”‚   â”‚   â”‚   â””â”€â”€ db: Session
â”‚   â”‚   â””â”€â”€ Methods:
â”‚   â”‚       â”œâ”€â”€ generate(user_id, limit) -> List[Recommendation]
â”‚   â”‚       â”œâ”€â”€ _build_user_profile(interactions) -> List[float]
â”‚   â”‚       â””â”€â”€ _compute_similarity(profile, resource_embedding) -> float
â”‚   â”‚
â”‚   â”œâ”€â”€ GraphBasedStrategy
â”‚   â”‚   â”œâ”€â”€ Attributes:
â”‚   â”‚   â”‚   â””â”€â”€ db: Session
â”‚   â”‚   â””â”€â”€ Methods:
â”‚   â”‚       â”œâ”€â”€ generate(user_id, limit) -> List[Recommendation]
â”‚   â”‚       â””â”€â”€ _traverse_citation_network(resource_id, depth=2) -> List[Tuple[str, float]]
â”‚   â”‚
â”‚   â””â”€â”€ HybridStrategy
â”‚       â”œâ”€â”€ Attributes:
â”‚       â”‚   â”œâ”€â”€ db: Session
â”‚       â”‚   â”œâ”€â”€ strategies: List[RecommendationStrategy]
â”‚       â”‚   â””â”€â”€ weights: List[float]
â”‚       â””â”€â”€ Methods:
â”‚           â”œâ”€â”€ generate(user_id, limit) -> List[Recommendation]
â”‚           â””â”€â”€ _merge_recommendations(strategy_results, weights) -> List[Recommendation]
```


### Search Service

```
AdvancedSearchService
â”œâ”€â”€ Public Methods:
â”‚   â”œâ”€â”€ hybrid_search(db, query, hybrid_weight=0.5) -> Tuple[List[Resource], int, Facets, Dict[str, str]]
â”‚   â”œâ”€â”€ fts_search(db, query, filters, limit, offset) -> Tuple[List[Resource], int, Facets, Dict[str, float], Dict[str, str]]
â”‚   â”œâ”€â”€ vector_search(db, query_text, limit, offset) -> Tuple[List[Resource], int, Facets]
â”‚   â”œâ”€â”€ parse_search_query(query: str) -> str
â”‚   â”œâ”€â”€ generate_snippets(text: str, query: str, max_length=200) -> str
â”‚   â””â”€â”€ _analyze_query(query: str) -> Dict[str, Any]
â”œâ”€â”€ Private Methods:
â”‚   â”œâ”€â”€ _search_sparse(db, query_text, limit=100) -> List[Tuple[str, float]]
â”‚   â”œâ”€â”€ _fetch_resources_ordered(db, resource_ids, filters) -> List[Resource]
â”‚   â””â”€â”€ _compute_facets(db, query) -> Facets

HybridSearchQuery
â”œâ”€â”€ Attributes:
â”‚   â”œâ”€â”€ db: Session
â”‚   â”œâ”€â”€ query: DomainSearchQuery
â”‚   â”œâ”€â”€ enable_reranking: bool
â”‚   â”œâ”€â”€ adaptive_weighting: bool
â”‚   â””â”€â”€ _diagnostics: Dict[str, Any]
â”œâ”€â”€ Public Methods:
â”‚   â”œâ”€â”€ __init__(db, query, enable_reranking=True, adaptive_weighting=True)
â”‚   â”œâ”€â”€ execute() -> Tuple[List[Resource], int, Facets, Dict[str, str], Dict[str, Any]]
â”‚   â””â”€â”€ get_diagnostic_info() -> Dict[str, Any]
â”œâ”€â”€ Private Methods:
â”‚   â”œâ”€â”€ _convert_to_schema_filters() -> SearchFilters | None
â”‚   â”œâ”€â”€ _ensure_tables_exist() -> None
â”‚   â”œâ”€â”€ _check_services_available() -> bool
â”‚   â”œâ”€â”€ _fallback_to_two_way_hybrid(start_time) -> Tuple[...]
â”‚   â”œâ”€â”€ _analyze_query() -> Dict[str, Any]
â”‚   â”œâ”€â”€ _execute_retrieval_phase() -> RetrievalCandidates
â”‚   â”œâ”€â”€ _execute_fusion_phase(candidates) -> FusedCandidates
â”‚   â”œâ”€â”€ _execute_reranking_phase(fused) -> List[Tuple[str, float]]
â”‚   â”œâ”€â”€ _search_fts5() -> List[Tuple[str, float]]
â”‚   â”œâ”€â”€ _search_dense() -> List[Tuple[str, float]]
â”‚   â”œâ”€â”€ _search_sparse() -> List[Tuple[str, float]]
â”‚   â”œâ”€â”€ _compute_weights() -> List[float]
â”‚   â”œâ”€â”€ _compute_method_contributions(fts5, dense, sparse) -> Dict[str, int]
â”‚   â”œâ”€â”€ _fetch_paginated_resources(fused_results) -> List[Resource]
â”‚   â”œâ”€â”€ _compute_facets(fused_results) -> Facets
â”‚   â””â”€â”€ _generate_snippets(resources) -> Dict[str, str]

RetrievalCandidates (dataclass)
â”œâ”€â”€ Attributes:
â”‚   â”œâ”€â”€ fts5_results: List[Tuple[str, float]]
â”‚   â”œâ”€â”€ dense_results: List[Tuple[str, float]]
â”‚   â”œâ”€â”€ sparse_results: List[Tuple[str, float]]
â”‚   â”œâ”€â”€ retrieval_time_ms: float
â”‚   â””â”€â”€ method_times_ms: Dict[str, float]
â”œâ”€â”€ Methods:
â”‚   â”œâ”€â”€ get_all_candidate_ids() -> set[str]
â”‚   â””â”€â”€ get_method_counts() -> Dict[str, int]

FusedCandidates (dataclass)
â”œâ”€â”€ Attributes:
â”‚   â”œâ”€â”€ fused_results: List[Tuple[str, float]]
â”‚   â”œâ”€â”€ weights_used: List[float]
â”‚   â”œâ”€â”€ fusion_time_ms: float
â”‚   â””â”€â”€ method_contributions: Dict[str, int]
â”œâ”€â”€ Methods:
â”‚   â”œâ”€â”€ get_top_k(k: int) -> List[Tuple[str, float]]
â”‚   â””â”€â”€ get_candidate_ids() -> List[str]

Module Functions:
â”œâ”€â”€ _detect_fts5(db: Session) -> bool
â”œâ”€â”€ _fts_index_ready(db: Session) -> bool
â”œâ”€â”€ _apply_structured_filters(q, filters) -> Any
â””â”€â”€ _compute_facets(db, query) -> Facets
```

---


## Refactoring Framework Architecture

The refactoring framework implements Fowler's refactoring patterns with automated code smell detection and validation.

### Refactoring Models

```
SmellType (Enum)
â”œâ”€â”€ Values:
â”‚   â”œâ”€â”€ DUPLICATED_CODE
â”‚   â”œâ”€â”€ LONG_FUNCTION
â”‚   â”œâ”€â”€ LARGE_CLASS
â”‚   â”œâ”€â”€ GLOBAL_DATA
â”‚   â”œâ”€â”€ FEATURE_ENVY
â”‚   â”œâ”€â”€ DATA_CLUMPS
â”‚   â”œâ”€â”€ PRIMITIVE_OBSESSION
â”‚   â”œâ”€â”€ REPEATED_SWITCHES
â”‚   â”œâ”€â”€ DATA_CLASS
â”‚   â””â”€â”€ LONG_PARAMETER_LIST

Severity (Enum)
â”œâ”€â”€ Values:
â”‚   â”œâ”€â”€ HIGH (blocks production)
â”‚   â”œâ”€â”€ MEDIUM (technical debt)
â”‚   â””â”€â”€ LOW (minor improvement)

RefactoringTechnique (Enum)
â”œâ”€â”€ Values:
â”‚   â”œâ”€â”€ EXTRACT_FUNCTION
â”‚   â”œâ”€â”€ EXTRACT_CLASS
â”‚   â”œâ”€â”€ REPLACE_PRIMITIVE_WITH_OBJECT
â”‚   â”œâ”€â”€ COMBINE_FUNCTIONS_INTO_CLASS
â”‚   â”œâ”€â”€ SEPARATE_QUERY_FROM_MODIFIER
â”‚   â”œâ”€â”€ ENCAPSULATE_COLLECTION
â”‚   â”œâ”€â”€ SPLIT_PHASE
â”‚   â”œâ”€â”€ REPLACE_CONDITIONAL_WITH_POLYMORPHISM
â”‚   â”œâ”€â”€ MOVE_FUNCTION
â”‚   â””â”€â”€ INLINE_FUNCTION

Location (dataclass)
â”œâ”€â”€ Attributes:
â”‚   â”œâ”€â”€ file_path: Path
â”‚   â”œâ”€â”€ start_line: int
â”‚   â”œâ”€â”€ end_line: int
â”‚   â”œâ”€â”€ function_name: Optional[str]
â”‚   â””â”€â”€ class_name: Optional[str]
â”œâ”€â”€ Methods:
â”‚   â””â”€â”€ __str__() -> str

CodeSmell (dataclass)
â”œâ”€â”€ Attributes:
â”‚   â”œâ”€â”€ smell_type: SmellType
â”‚   â”œâ”€â”€ severity: Severity
â”‚   â”œâ”€â”€ location: Location
â”‚   â”œâ”€â”€ description: str
â”‚   â”œâ”€â”€ suggested_technique: RefactoringTechnique
â”‚   â””â”€â”€ metrics: Dict[str, Any]
â”œâ”€â”€ Methods:
â”‚   â””â”€â”€ __str__() -> str

SmellReport (dataclass)
â”œâ”€â”€ Attributes:
â”‚   â”œâ”€â”€ file_path: Path
â”‚   â”œâ”€â”€ smells: List[CodeSmell]
â”‚   â”œâ”€â”€ total_lines: int
â”‚   â”œâ”€â”€ complexity_score: float
â”‚   â””â”€â”€ timestamp: str
â”œâ”€â”€ Methods:
â”‚   â”œâ”€â”€ high_priority_smells() -> List[CodeSmell]
â”‚   â”œâ”€â”€ smells_by_type(smell_type) -> List[CodeSmell]
â”‚   â””â”€â”€ summary() -> str

RefactoringResult (dataclass)
â”œâ”€â”€ Attributes:
â”‚   â”œâ”€â”€ success: bool
â”‚   â”œâ”€â”€ original_code: str
â”‚   â”œâ”€â”€ refactored_code: str
â”‚   â”œâ”€â”€ technique_applied: RefactoringTechnique
â”‚   â”œâ”€â”€ changes_made: List[str]
â”‚   â””â”€â”€ test_results: Optional[TestResults]
â”œâ”€â”€ Methods:
â”‚   â””â”€â”€ summary() -> str

TestResults (dataclass)
â”œâ”€â”€ Attributes:
â”‚   â”œâ”€â”€ total_tests: int
â”‚   â”œâ”€â”€ passed: int
â”‚   â”œâ”€â”€ failed: int
â”‚   â”œâ”€â”€ errors: List[str]
â”‚   â”œâ”€â”€ coverage_percentage: float
â”‚   â””â”€â”€ execution_time_seconds: float
â”œâ”€â”€ Methods:
â”‚   â”œâ”€â”€ all_passed() -> bool
â”‚   â”œâ”€â”€ coverage_acceptable(threshold=0.85) -> bool
â”‚   â””â”€â”€ summary() -> str

ServiceRefactoringStatus (dataclass)
â”œâ”€â”€ Attributes:
â”‚   â”œâ”€â”€ service_name: str
â”‚   â”œâ”€â”€ file_path: Path
â”‚   â”œâ”€â”€ status: str
â”‚   â”œâ”€â”€ smells_detected: int
â”‚   â”œâ”€â”€ smells_fixed: int
â”‚   â”œâ”€â”€ techniques_applied: List[RefactoringTechnique]
â”‚   â”œâ”€â”€ test_coverage_before: float
â”‚   â”œâ”€â”€ test_coverage_after: float
â”‚   â”œâ”€â”€ lines_before: int
â”‚   â”œâ”€â”€ lines_after: int
â”‚   â”œâ”€â”€ functions_before: int
â”‚   â””â”€â”€ functions_after: int
â”œâ”€â”€ Methods:
â”‚   â””â”€â”€ improvement_percentage() -> float
```


### Refactoring Detector

```
PrioritizedSmells (dataclass)
â”œâ”€â”€ Attributes:
â”‚   â”œâ”€â”€ high_priority: List[CodeSmell]
â”‚   â”œâ”€â”€ medium_priority: List[CodeSmell]
â”‚   â””â”€â”€ low_priority: List[CodeSmell]
â”œâ”€â”€ Methods:
â”‚   â”œâ”€â”€ total_count() -> int
â”‚   â””â”€â”€ summary() -> str

CodeSmellDetector
â”œâ”€â”€ Attributes:
â”‚   â”œâ”€â”€ function_checker: FunctionLengthChecker
â”‚   â”œâ”€â”€ class_checker: ClassSizeChecker
â”‚   â”œâ”€â”€ type_hint_checker: TypeHintCoverageChecker
â”‚   â””â”€â”€ duplication_detector: CodeDuplicationDetector
â”œâ”€â”€ Public Methods:
â”‚   â”œâ”€â”€ __init__()
â”‚   â”œâ”€â”€ analyze_file(file_path: Path) -> SmellReport
â”‚   â”œâ”€â”€ analyze_directory(dir_path: Path) -> List[SmellReport]
â”‚   â”œâ”€â”€ prioritize_smells(reports: List[SmellReport]) -> PrioritizedSmells
â”‚   â””â”€â”€ generate_summary_report(reports: List[SmellReport]) -> str
â”œâ”€â”€ Private Methods:
â”‚   â”œâ”€â”€ _detect_feature_envy(file_path) -> List[CodeSmell]
â”‚   â”œâ”€â”€ _detect_long_parameter_lists(file_path) -> List[CodeSmell]
â”‚   â”œâ”€â”€ _count_lines(file_path) -> int
â”‚   â””â”€â”€ _calculate_complexity(file_path) -> float
```

### Refactoring Validators

```
FunctionInfo (dataclass)
â”œâ”€â”€ Attributes:
â”‚   â”œâ”€â”€ name: str
â”‚   â”œâ”€â”€ start_line: int
â”‚   â”œâ”€â”€ end_line: int
â”‚   â”œâ”€â”€ line_count: int
â”‚   â”œâ”€â”€ class_name: Optional[str]
â”‚   â”œâ”€â”€ has_type_hints: bool
â”‚   â””â”€â”€ parameter_count: int

ClassInfo (dataclass)
â”œâ”€â”€ Attributes:
â”‚   â”œâ”€â”€ name: str
â”‚   â”œâ”€â”€ start_line: int
â”‚   â”œâ”€â”€ end_line: int
â”‚   â”œâ”€â”€ line_count: int
â”‚   â”œâ”€â”€ method_count: int
â”‚   â””â”€â”€ public_method_count: int

FunctionLengthChecker
â”œâ”€â”€ Attributes:
â”‚   â””â”€â”€ max_lines: int
â”œâ”€â”€ Constants:
â”‚   â””â”€â”€ MAX_FUNCTION_LINES = 50
â”œâ”€â”€ Methods:
â”‚   â”œâ”€â”€ __init__(max_lines=50)
â”‚   â”œâ”€â”€ check_file(file_path: Path) -> List[CodeSmell]
â”‚   â”œâ”€â”€ _extract_functions(tree, source) -> List[FunctionInfo]
â”‚   â”œâ”€â”€ _analyze_function(node, source) -> FunctionInfo
â”‚   â””â”€â”€ _create_smell(file_path, func) -> CodeSmell

ClassSizeChecker
â”œâ”€â”€ Attributes:
â”‚   â”œâ”€â”€ max_lines: int
â”‚   â””â”€â”€ max_methods: int
â”œâ”€â”€ Constants:
â”‚   â”œâ”€â”€ MAX_CLASS_LINES = 200
â”‚   â””â”€â”€ MAX_METHODS = 10
â”œâ”€â”€ Methods:
â”‚   â”œâ”€â”€ __init__(max_lines=200, max_methods=10)
â”‚   â”œâ”€â”€ check_file(file_path: Path) -> List[CodeSmell]
â”‚   â”œâ”€â”€ _extract_classes(tree, source) -> List[ClassInfo]
â”‚   â”œâ”€â”€ _analyze_class(node, source) -> ClassInfo
â”‚   â””â”€â”€ _create_smell(file_path, cls) -> CodeSmell

TypeHintCoverageChecker
â”œâ”€â”€ Attributes:
â”‚   â””â”€â”€ min_coverage: float
â”œâ”€â”€ Constants:
â”‚   â””â”€â”€ MIN_TYPE_HINT_COVERAGE = 1.0
â”œâ”€â”€ Methods:
â”‚   â”œâ”€â”€ __init__(min_coverage=1.0)
â”‚   â”œâ”€â”€ check_file(file_path: Path) -> Tuple[float, List[CodeSmell]]
â”‚   â”œâ”€â”€ _has_complete_type_hints(node) -> bool
â”‚   â””â”€â”€ _create_smell(file_path, node) -> CodeSmell

CodeDuplicationDetector
â”œâ”€â”€ Attributes:
â”‚   â””â”€â”€ similarity_threshold: float
â”œâ”€â”€ Constants:
â”‚   â””â”€â”€ DUPLICATION_SIMILARITY_THRESHOLD = 0.8
â”œâ”€â”€ Methods:
â”‚   â”œâ”€â”€ __init__(similarity_threshold=0.8)
â”‚   â”œâ”€â”€ check_files(file_paths: List[Path]) -> List[CodeSmell]
â”‚   â”œâ”€â”€ _extract_function_bodies(tree, source) -> List[Tuple[ast.FunctionDef, str]]
â”‚   â”œâ”€â”€ _calculate_similarity(body1, body2) -> float
â”‚   â””â”€â”€ _create_smell(file1, func1, file2, func2, similarity) -> CodeSmell
```

---


## Router Layer Architecture

The router layer provides FastAPI endpoints for all services, implementing REST API patterns.

### Main Routers

```
Classification Router (/api/classification)
â”œâ”€â”€ Endpoints:
â”‚   â”œâ”€â”€ POST /classify
â”‚   â”‚   â”œâ”€â”€ Input: ClassifyRequest (text, top_k)
â”‚   â”‚   â””â”€â”€ Output: ClassificationResult
â”‚   â”œâ”€â”€ POST /fine-tune
â”‚   â”‚   â”œâ”€â”€ Input: FineTuneRequest (labeled_data, epochs, batch_size)
â”‚   â”‚   â””â”€â”€ Output: TrainingMetrics
â”‚   â””â”€â”€ GET /metrics
â”‚       â””â”€â”€ Output: ModelMetrics

Quality Router (/api/quality)
â”œâ”€â”€ Endpoints:
â”‚   â”œâ”€â”€ POST /compute/{resource_id}
â”‚   â”‚   â”œâ”€â”€ Input: Optional[QualityWeights]
â”‚   â”‚   â””â”€â”€ Output: QualityScore
â”‚   â”œâ”€â”€ GET /monitor/degradation
â”‚   â”‚   â”œâ”€â”€ Query: time_window_days
â”‚   â”‚   â””â”€â”€ Output: List[DegradationReport]
â”‚   â””â”€â”€ POST /detect/outliers
â”‚       â”œâ”€â”€ Query: batch_size
â”‚       â””â”€â”€ Output: OutlierDetectionResult

Recommendation Router (/api/recommendations)
â”œâ”€â”€ Endpoints:
â”‚   â”œâ”€â”€ GET /user/{user_id}
â”‚   â”‚   â”œâ”€â”€ Query: limit, strategy
â”‚   â”‚   â””â”€â”€ Output: List[Recommendation]
â”‚   â”œâ”€â”€ GET /resource/{resource_id}
â”‚   â”‚   â”œâ”€â”€ Query: limit
â”‚   â”‚   â””â”€â”€ Output: List[Recommendation]
â”‚   â””â”€â”€ GET /graph/{resource_id}
â”‚       â”œâ”€â”€ Query: limit, graph_weight
â”‚       â””â”€â”€ Output: List[Recommendation]

Search Router (/api/search)
â”œâ”€â”€ Endpoints:
â”‚   â”œâ”€â”€ POST /hybrid
â”‚   â”‚   â”œâ”€â”€ Input: SearchQuery
â”‚   â”‚   â””â”€â”€ Output: SearchResults
â”‚   â”œâ”€â”€ POST /fts
â”‚   â”‚   â”œâ”€â”€ Input: SearchQuery
â”‚   â”‚   â””â”€â”€ Output: SearchResults
â”‚   â”œâ”€â”€ POST /vector
â”‚   â”‚   â”œâ”€â”€ Input: SearchQuery
â”‚   â”‚   â””â”€â”€ Output: SearchResults
â”‚   â””â”€â”€ POST /three-way
â”‚       â”œâ”€â”€ Input: SearchQuery
â”‚       â””â”€â”€ Output: SearchResults

Resource Router (/api/resources)
â”œâ”€â”€ Endpoints:
â”‚   â”œâ”€â”€ GET /
â”‚   â”‚   â”œâ”€â”€ Query: skip, limit, filters
â”‚   â”‚   â””â”€â”€ Output: List[Resource]
â”‚   â”œâ”€â”€ GET /{resource_id}
â”‚   â”‚   â””â”€â”€ Output: Resource
â”‚   â”œâ”€â”€ POST /
â”‚   â”‚   â”œâ”€â”€ Input: ResourceCreate
â”‚   â”‚   â””â”€â”€ Output: Resource
â”‚   â”œâ”€â”€ PUT /{resource_id}
â”‚   â”‚   â”œâ”€â”€ Input: ResourceUpdate
â”‚   â”‚   â””â”€â”€ Output: Resource
â”‚   â””â”€â”€ DELETE /{resource_id}
â”‚       â””â”€â”€ Output: DeleteResponse

Taxonomy Router (/api/taxonomy)
â”œâ”€â”€ Endpoints:
â”‚   â”œâ”€â”€ GET /nodes
â”‚   â”‚   â””â”€â”€ Output: List[TaxonomyNode]
â”‚   â”œâ”€â”€ GET /nodes/{node_id}
â”‚   â”‚   â””â”€â”€ Output: TaxonomyNode
â”‚   â”œâ”€â”€ POST /nodes
â”‚   â”‚   â”œâ”€â”€ Input: TaxonomyNodeCreate
â”‚   â”‚   â””â”€â”€ Output: TaxonomyNode
â”‚   â””â”€â”€ GET /tree
â”‚       â””â”€â”€ Output: TaxonomyTree

Annotation Router (/api/annotations)
â”œâ”€â”€ Endpoints:
â”‚   â”œâ”€â”€ GET /resource/{resource_id}
â”‚   â”‚   â””â”€â”€ Output: List[Annotation]
â”‚   â”œâ”€â”€ POST /
â”‚   â”‚   â”œâ”€â”€ Input: AnnotationCreate
â”‚   â”‚   â””â”€â”€ Output: Annotation
â”‚   â”œâ”€â”€ PUT /{annotation_id}
â”‚   â”‚   â”œâ”€â”€ Input: AnnotationUpdate
â”‚   â”‚   â””â”€â”€ Output: Annotation
â”‚   â””â”€â”€ DELETE /{annotation_id}
â”‚       â””â”€â”€ Output: DeleteResponse

Graph Router (/api/graph)
â”œâ”€â”€ Endpoints:
â”‚   â”œâ”€â”€ GET /citations/{resource_id}
â”‚   â”‚   â””â”€â”€ Output: CitationGraph
â”‚   â”œâ”€â”€ GET /embeddings/{resource_id}
â”‚   â”‚   â””â”€â”€ Output: GraphEmbedding
â”‚   â””â”€â”€ POST /analyze
â”‚       â”œâ”€â”€ Input: GraphAnalysisRequest
â”‚       â””â”€â”€ Output: GraphAnalysisResult
```

---


## Database Layer Architecture

The database layer implements SQLAlchemy ORM models and database operations.

### Core Database Models

```
Resource (SQLAlchemy Model)
â”œâ”€â”€ Table: resources
â”œâ”€â”€ Attributes:
â”‚   â”œâ”€â”€ id: UUID (PK)
â”‚   â”œâ”€â”€ title: String
â”‚   â”œâ”€â”€ description: Text
â”‚   â”œâ”€â”€ creator: String
â”‚   â”œâ”€â”€ subject: JSON (List[str])
â”‚   â”œâ”€â”€ type: String
â”‚   â”œâ”€â”€ language: String
â”‚   â”œâ”€â”€ identifier: String
â”‚   â”œâ”€â”€ doi: String
â”‚   â”œâ”€â”€ publication_year: Integer
â”‚   â”œâ”€â”€ classification_code: String
â”‚   â”œâ”€â”€ embedding: JSON (List[float])
â”‚   â”œâ”€â”€ sparse_embedding: JSON
â”‚   â”œâ”€â”€ quality_overall: Float
â”‚   â”œâ”€â”€ quality_accuracy: Float
â”‚   â”œâ”€â”€ quality_completeness: Float
â”‚   â”œâ”€â”€ quality_consistency: Float
â”‚   â”œâ”€â”€ quality_timeliness: Float
â”‚   â”œâ”€â”€ quality_relevance: Float
â”‚   â”œâ”€â”€ quality_weights: JSON
â”‚   â”œâ”€â”€ quality_computation_version: String
â”‚   â”œâ”€â”€ quality_last_computed: DateTime
â”‚   â”œâ”€â”€ is_quality_outlier: Boolean
â”‚   â”œâ”€â”€ outlier_score: Float
â”‚   â”œâ”€â”€ outlier_reasons: JSON
â”‚   â”œâ”€â”€ needs_quality_review: Boolean
â”‚   â”œâ”€â”€ created_at: DateTime
â”‚   â””â”€â”€ updated_at: DateTime
â”œâ”€â”€ Relationships:
â”‚   â”œâ”€â”€ annotations: List[Annotation]
â”‚   â”œâ”€â”€ citations: List[Citation]
â”‚   â”œâ”€â”€ taxonomy_assignments: List[ResourceTaxonomy]
â”‚   â””â”€â”€ interactions: List[UserInteraction]

TaxonomyNode (SQLAlchemy Model)
â”œâ”€â”€ Table: taxonomy_nodes
â”œâ”€â”€ Attributes:
â”‚   â”œâ”€â”€ id: UUID (PK)
â”‚   â”œâ”€â”€ code: String (unique)
â”‚   â”œâ”€â”€ name: String
â”‚   â”œâ”€â”€ description: Text
â”‚   â”œâ”€â”€ parent_id: UUID (FK)
â”‚   â”œâ”€â”€ level: Integer
â”‚   â”œâ”€â”€ created_at: DateTime
â”‚   â””â”€â”€ updated_at: DateTime
â”œâ”€â”€ Relationships:
â”‚   â”œâ”€â”€ parent: TaxonomyNode
â”‚   â”œâ”€â”€ children: List[TaxonomyNode]
â”‚   â””â”€â”€ resource_assignments: List[ResourceTaxonomy]

ResourceTaxonomy (SQLAlchemy Model)
â”œâ”€â”€ Table: resource_taxonomy
â”œâ”€â”€ Attributes:
â”‚   â”œâ”€â”€ id: UUID (PK)
â”‚   â”œâ”€â”€ resource_id: UUID (FK)
â”‚   â”œâ”€â”€ taxonomy_node_id: UUID (FK)
â”‚   â”œâ”€â”€ confidence: Float
â”‚   â”œâ”€â”€ assigned_by: String
â”‚   â”œâ”€â”€ assignment_method: String
â”‚   â”œâ”€â”€ created_at: DateTime
â”‚   â””â”€â”€ updated_at: DateTime
â”œâ”€â”€ Relationships:
â”‚   â”œâ”€â”€ resource: Resource
â”‚   â””â”€â”€ taxonomy_node: TaxonomyNode

Annotation (SQLAlchemy Model)
â”œâ”€â”€ Table: annotations
â”œâ”€â”€ Attributes:
â”‚   â”œâ”€â”€ id: UUID (PK)
â”‚   â”œâ”€â”€ resource_id: UUID (FK)
â”‚   â”œâ”€â”€ user_id: String
â”‚   â”œâ”€â”€ content: Text
â”‚   â”œâ”€â”€ annotation_type: String
â”‚   â”œâ”€â”€ start_position: Integer
â”‚   â”œâ”€â”€ end_position: Integer
â”‚   â”œâ”€â”€ tags: JSON (List[str])
â”‚   â”œâ”€â”€ created_at: DateTime
â”‚   â””â”€â”€ updated_at: DateTime
â”œâ”€â”€ Relationships:
â”‚   â””â”€â”€ resource: Resource

Citation (SQLAlchemy Model)
â”œâ”€â”€ Table: citations
â”œâ”€â”€ Attributes:
â”‚   â”œâ”€â”€ id: UUID (PK)
â”‚   â”œâ”€â”€ source_resource_id: UUID (FK)
â”‚   â”œâ”€â”€ target_resource_id: UUID (FK)
â”‚   â”œâ”€â”€ citation_type: String
â”‚   â”œâ”€â”€ context: Text
â”‚   â”œâ”€â”€ created_at: DateTime
â”‚   â””â”€â”€ updated_at: DateTime
â”œâ”€â”€ Relationships:
â”‚   â”œâ”€â”€ source_resource: Resource
â”‚   â””â”€â”€ target_resource: Resource

UserInteraction (SQLAlchemy Model)
â”œâ”€â”€ Table: user_interactions
â”œâ”€â”€ Attributes:
â”‚   â”œâ”€â”€ id: UUID (PK)
â”‚   â”œâ”€â”€ user_id: String
â”‚   â”œâ”€â”€ resource_id: UUID (FK)
â”‚   â”œâ”€â”€ interaction_type: String
â”‚   â”œâ”€â”€ rating: Float
â”‚   â”œâ”€â”€ duration_seconds: Integer
â”‚   â”œâ”€â”€ created_at: DateTime
â”‚   â””â”€â”€ updated_at: DateTime
â”œâ”€â”€ Relationships:
â”‚   â””â”€â”€ resource: Resource

Collection (SQLAlchemy Model)
â”œâ”€â”€ Table: collections
â”œâ”€â”€ Attributes:
â”‚   â”œâ”€â”€ id: UUID (PK)
â”‚   â”œâ”€â”€ name: String
â”‚   â”œâ”€â”€ description: Text
â”‚   â”œâ”€â”€ owner_id: String
â”‚   â”œâ”€â”€ is_public: Boolean
â”‚   â”œâ”€â”€ created_at: DateTime
â”‚   â””â”€â”€ updated_at: DateTime
â”œâ”€â”€ Relationships:
â”‚   â””â”€â”€ resources: List[Resource] (many-to-many)
```

### Database Session Management

```
SessionLocal
â”œâ”€â”€ Factory function for creating database sessions
â”œâ”€â”€ Usage: with SessionLocal() as db: ...

get_db()
â”œâ”€â”€ FastAPI dependency for database sessions
â”œâ”€â”€ Yields: Session
â””â”€â”€ Usage: db: Session = Depends(get_db)

Base
â”œâ”€â”€ SQLAlchemy declarative base
â””â”€â”€ All models inherit from Base
```

---


## Utility Layer Architecture

The utility layer provides helper functions and shared utilities across the application.

### Text Processing Utilities

```
text_processor module
â”œâ”€â”€ Functions:
â”‚   â”œâ”€â”€ readability_scores(text: str) -> Dict[str, float]
â”‚   â”‚   â”œâ”€â”€ Returns: flesch_reading_ease, flesch_kincaid_grade, etc.
â”‚   â”‚   â””â”€â”€ Uses: textstat library
â”‚   â”œâ”€â”€ extract_keywords(text: str, top_k: int) -> List[str]
â”‚   â”‚   â”œâ”€â”€ Returns: List of top keywords
â”‚   â”‚   â””â”€â”€ Uses: TF-IDF or RAKE
â”‚   â”œâ”€â”€ clean_text(text: str) -> str
â”‚   â”‚   â”œâ”€â”€ Removes: HTML tags, special characters
â”‚   â”‚   â””â”€â”€ Returns: Cleaned text
â”‚   â”œâ”€â”€ tokenize(text: str) -> List[str]
â”‚   â”‚   â””â”€â”€ Returns: List of tokens
â”‚   â””â”€â”€ normalize_text(text: str) -> str
â”‚       â”œâ”€â”€ Lowercases, removes punctuation
â”‚       â””â”€â”€ Returns: Normalized text

content_extractor module
â”œâ”€â”€ Functions:
â”‚   â”œâ”€â”€ extract_from_pdf(file_path: Path) -> str
â”‚   â”‚   â””â”€â”€ Uses: PyPDF2 or pdfplumber
â”‚   â”œâ”€â”€ extract_from_html(html: str) -> str
â”‚   â”‚   â””â”€â”€ Uses: BeautifulSoup
â”‚   â”œâ”€â”€ extract_metadata(file_path: Path) -> Dict[str, Any]
â”‚   â”‚   â””â”€â”€ Returns: Title, author, date, etc.
â”‚   â””â”€â”€ extract_citations(text: str) -> List[str]
â”‚       â””â”€â”€ Returns: List of citation strings

table_extractor module
â”œâ”€â”€ Functions:
â”‚   â”œâ”€â”€ extract_tables_from_pdf(file_path: Path) -> List[pd.DataFrame]
â”‚   â”‚   â””â”€â”€ Uses: tabula-py or camelot
â”‚   â”œâ”€â”€ extract_tables_from_html(html: str) -> List[pd.DataFrame]
â”‚   â”‚   â””â”€â”€ Uses: pandas.read_html
â”‚   â””â”€â”€ format_table_as_text(df: pd.DataFrame) -> str
â”‚       â””â”€â”€ Returns: Formatted table string

equation_parser module
â”œâ”€â”€ Functions:
â”‚   â”œâ”€â”€ extract_equations(text: str) -> List[str]
â”‚   â”‚   â””â”€â”€ Returns: List of LaTeX equations
â”‚   â”œâ”€â”€ parse_latex(latex: str) -> Dict[str, Any]
â”‚   â”‚   â””â”€â”€ Returns: Parsed equation structure
â”‚   â””â”€â”€ render_equation(latex: str) -> Image
â”‚       â””â”€â”€ Returns: Rendered equation image
```

### Performance Monitoring Utilities

```
performance_monitoring module
â”œâ”€â”€ Classes:
â”‚   â””â”€â”€ PerformanceMonitor
â”‚       â”œâ”€â”€ Attributes:
â”‚       â”‚   â”œâ”€â”€ metrics: Dict[str, List[float]]
â”‚       â”‚   â””â”€â”€ start_times: Dict[str, float]
â”‚       â”œâ”€â”€ Methods:
â”‚       â”‚   â”œâ”€â”€ start_timer(name: str) -> None
â”‚       â”‚   â”œâ”€â”€ stop_timer(name: str) -> float
â”‚       â”‚   â”œâ”€â”€ record_metric(name: str, value: float) -> None
â”‚       â”‚   â”œâ”€â”€ get_average(name: str) -> float
â”‚       â”‚   â”œâ”€â”€ get_percentile(name: str, percentile: float) -> float
â”‚       â”‚   â””â”€â”€ get_summary() -> Dict[str, Any]
â”‚
â”œâ”€â”€ Decorators:
â”‚   â”œâ”€â”€ @time_function
â”‚   â”‚   â””â”€â”€ Measures function execution time
â”‚   â””â”€â”€ @log_performance
â”‚       â””â”€â”€ Logs performance metrics

recommendation_metrics module
â”œâ”€â”€ Functions:
â”‚   â”œâ”€â”€ precision_at_k(predictions, ground_truth, k) -> float
â”‚   â”œâ”€â”€ recall_at_k(predictions, ground_truth, k) -> float
â”‚   â”œâ”€â”€ ndcg_at_k(predictions, ground_truth, k) -> float
â”‚   â”œâ”€â”€ mean_average_precision(predictions, ground_truth) -> float
â”‚   â””â”€â”€ hit_rate_at_k(predictions, ground_truth, k) -> float
```

---


## ML Monitoring Architecture

The ML monitoring layer provides observability for machine learning models and predictions.

```
PredictionMonitor
â”œâ”€â”€ Attributes:
â”‚   â”œâ”€â”€ predictions: List[Dict[str, Any]]
â”‚   â”œâ”€â”€ metrics: Dict[str, float]
â”‚   â””â”€â”€ alert_thresholds: Dict[str, float]
â”œâ”€â”€ Methods:
â”‚   â”œâ”€â”€ __init__()
â”‚   â”œâ”€â”€ log_prediction(model_name, input_data, prediction, confidence, latency_ms) -> None
â”‚   â”œâ”€â”€ get_metrics(window_minutes: int) -> Dict[str, Any]
â”‚   â”œâ”€â”€ get_prediction_distribution() -> Dict[str, int]
â”‚   â”œâ”€â”€ get_average_confidence() -> float
â”‚   â”œâ”€â”€ get_average_latency() -> float
â”‚   â”œâ”€â”€ check_drift(baseline_distribution) -> bool
â”‚   â””â”€â”€ export_metrics() -> Dict[str, Any]

AlertManager
â”œâ”€â”€ Attributes:
â”‚   â”œâ”€â”€ alerts: List[Alert]
â”‚   â””â”€â”€ notification_channels: List[NotificationChannel]
â”œâ”€â”€ Methods:
â”‚   â”œâ”€â”€ __init__()
â”‚   â”œâ”€â”€ create_alert(alert_type, severity, message, metadata) -> Alert
â”‚   â”œâ”€â”€ check_thresholds(metrics: Dict[str, float]) -> List[Alert]
â”‚   â”œâ”€â”€ send_notification(alert: Alert) -> None
â”‚   â””â”€â”€ get_active_alerts() -> List[Alert]

HealthCheck
â”œâ”€â”€ Methods:
â”‚   â”œâ”€â”€ check_model_health(model_name: str) -> Dict[str, Any]
â”‚   â”œâ”€â”€ check_database_health() -> Dict[str, Any]
â”‚   â”œâ”€â”€ check_service_health(service_name: str) -> Dict[str, Any]
â”‚   â””â”€â”€ get_system_health() -> Dict[str, Any]

JSONLogging
â”œâ”€â”€ Functions:
â”‚   â”œâ”€â”€ setup_json_logging(log_level: str) -> None
â”‚   â”œâ”€â”€ log_structured(level, message, **kwargs) -> None
â”‚   â””â”€â”€ get_logger(name: str) -> logging.Logger
```

---

## Schema Layer Architecture

The schema layer defines Pydantic models for API request/response validation.

```
SearchQuery (Pydantic)
â”œâ”€â”€ Attributes:
â”‚   â”œâ”€â”€ text: str
â”‚   â”œâ”€â”€ limit: int = 20
â”‚   â”œâ”€â”€ offset: int = 0
â”‚   â”œâ”€â”€ hybrid_weight: float = 0.5
â”‚   â”œâ”€â”€ filters: Optional[SearchFilters]
â”‚   â””â”€â”€ sort_by: Optional[str]

SearchFilters (Pydantic)
â”œâ”€â”€ Attributes:
â”‚   â”œâ”€â”€ classification_code: Optional[List[str]]
â”‚   â”œâ”€â”€ type: Optional[List[str]]
â”‚   â”œâ”€â”€ language: Optional[List[str]]
â”‚   â”œâ”€â”€ year_min: Optional[int]
â”‚   â””â”€â”€ year_max: Optional[int]

ResourceCreate (Pydantic)
â”œâ”€â”€ Attributes:
â”‚   â”œâ”€â”€ title: str
â”‚   â”œâ”€â”€ description: Optional[str]
â”‚   â”œâ”€â”€ creator: Optional[str]
â”‚   â”œâ”€â”€ subject: Optional[List[str]]
â”‚   â”œâ”€â”€ type: str
â”‚   â”œâ”€â”€ language: str
â”‚   â””â”€â”€ identifier: str

ResourceUpdate (Pydantic)
â”œâ”€â”€ Attributes:
â”‚   â”œâ”€â”€ title: Optional[str]
â”‚   â”œâ”€â”€ description: Optional[str]
â”‚   â”œâ”€â”€ creator: Optional[str]
â”‚   â”œâ”€â”€ subject: Optional[List[str]]
â”‚   â””â”€â”€ classification_code: Optional[str]

ClassifyRequest (Pydantic)
â”œâ”€â”€ Attributes:
â”‚   â”œâ”€â”€ text: str
â”‚   â””â”€â”€ top_k: int = 5

AnnotationCreate (Pydantic)
â”œâ”€â”€ Attributes:
â”‚   â”œâ”€â”€ resource_id: UUID
â”‚   â”œâ”€â”€ content: str
â”‚   â”œâ”€â”€ annotation_type: str
â”‚   â”œâ”€â”€ start_position: Optional[int]
â”‚   â”œâ”€â”€ end_position: Optional[int]
â”‚   â””â”€â”€ tags: Optional[List[str]]

RecommendationRequest (Pydantic)
â”œâ”€â”€ Attributes:
â”‚   â”œâ”€â”€ user_id: str
â”‚   â”œâ”€â”€ limit: int = 10
â”‚   â””â”€â”€ strategy: str = "hybrid"
```

---


## Configuration Layer Architecture

The configuration layer manages application settings and environment variables.

```
Settings (Pydantic BaseSettings)
â”œâ”€â”€ Attributes:
â”‚   â”œâ”€â”€ DATABASE_URL: str
â”‚   â”œâ”€â”€ SECRET_KEY: str
â”‚   â”œâ”€â”€ API_VERSION: str = "v2.0"
â”‚   â”œâ”€â”€ DEBUG: bool = False
â”‚   â”œâ”€â”€ LOG_LEVEL: str = "INFO"
â”‚   â”œâ”€â”€ CORS_ORIGINS: List[str]
â”‚   â”œâ”€â”€ MAX_UPLOAD_SIZE: int
â”‚   â”œâ”€â”€ EMBEDDING_MODEL: str = "sentence-transformers/all-MiniLM-L6-v2"
â”‚   â”œâ”€â”€ CLASSIFICATION_MODEL: str = "distilbert-base-uncased"
â”‚   â”œâ”€â”€ ENABLE_GPU: bool = True
â”‚   â”œâ”€â”€ CACHE_TTL: int = 3600
â”‚   â””â”€â”€ RATE_LIMIT: int = 100
â”œâ”€â”€ Methods:
â”‚   â”œâ”€â”€ get_database_url() -> str
â”‚   â”œâ”€â”€ is_production() -> bool
â”‚   â””â”€â”€ validate_settings() -> None

get_settings()
â”œâ”€â”€ Returns: Settings (singleton)
â””â”€â”€ Usage: settings = get_settings()
```

---

## Complete System Flow Diagrams

### Classification Flow

```
User Request
    â†“
FastAPI Router (POST /api/classification/classify)
    â†“
MLClassificationService.predict(text, top_k)
    â†“
    â”œâ”€â†’ _load_model() [if not loaded]
    â”‚   â”œâ”€â†’ _import_ml_libraries()
    â”‚   â”œâ”€â†’ _load_tokenizer()
    â”‚   â”œâ”€â†’ _determine_checkpoint_path()
    â”‚   â”œâ”€â†’ _load_model_from_checkpoint()
    â”‚   â””â”€â†’ _move_model_to_device()
    â”‚
    â”œâ”€â†’ Tokenize input text
    â”œâ”€â†’ Model inference (forward pass)
    â”œâ”€â†’ Apply sigmoid activation
    â”œâ”€â†’ Sort by confidence
    â”œâ”€â†’ Take top_k predictions
    â”‚
    â””â”€â†’ Create ClassificationResult domain object
        â”œâ”€â†’ ClassificationPrediction objects
        â””â”€â†’ Validate all predictions
    â†“
PredictionMonitor.log_prediction()
    â†“
Return ClassificationResult
    â†“
Convert to JSON response
    â†“
User receives predictions
```

### Quality Assessment Flow

```
User Request
    â†“
FastAPI Router (POST /api/quality/compute/{resource_id})
    â†“
QualityService.compute_quality(resource_id, weights)
    â†“
    â”œâ”€â†’ Validate weights
    â”œâ”€â†’ Query Resource from database
    â”‚
    â”œâ”€â†’ _compute_accuracy_dimension(resource)
    â”œâ”€â†’ _compute_completeness_dimension(resource)
    â”œâ”€â†’ _compute_consistency_dimension(resource)
    â”œâ”€â†’ _compute_timeliness_dimension(resource)
    â””â”€â†’ _compute_relevance_dimension(resource)
    â†“
Create QualityScore domain object
    â”œâ”€â†’ Validate all dimensions (0.0-1.0)
    â””â”€â†’ Calculate overall_score()
    â†“
_update_resource_quality_fields(resource, ...)
    â†“
Database commit
    â†“
Return QualityScore
    â†“
Convert to JSON response
    â†“
User receives quality assessment
```


### Recommendation Flow (Strategy Pattern)

```
User Request
    â†“
FastAPI Router (GET /api/recommendations/user/{user_id})
    â†“
generate_recommendations(db, resource_id, limit, strategy, user_id)
    â†“
RecommendationStrategyFactory.create(strategy_type, db)
    â†“
    â”œâ”€â†’ strategy="collaborative" â†’ CollaborativeFilteringStrategy
    â”œâ”€â†’ strategy="content" â†’ ContentBasedStrategy
    â”œâ”€â†’ strategy="graph" â†’ GraphBasedStrategy
    â””â”€â†’ strategy="hybrid" â†’ HybridStrategy
    â†“
Strategy.generate(user_id, limit)
    â†“
    [CollaborativeFilteringStrategy]
    â”œâ”€â†’ _build_user_item_matrix()
    â”œâ”€â†’ Compute user similarities
    â”œâ”€â†’ Generate predictions
    â””â”€â†’ Create Recommendation objects
    
    [ContentBasedStrategy]
    â”œâ”€â†’ Query UserInteraction
    â”œâ”€â†’ _build_user_profile(interactions)
    â”œâ”€â†’ Query Resources with embeddings
    â”œâ”€â†’ _compute_similarity(profile, embedding)
    â””â”€â†’ Create Recommendation objects
    
    [GraphBasedStrategy]
    â”œâ”€â†’ _traverse_citation_network(resource_id, depth)
    â”œâ”€â†’ Score by citation distance
    â””â”€â†’ Create Recommendation objects
    
    [HybridStrategy]
    â”œâ”€â†’ Execute all sub-strategies
    â”œâ”€â†’ _merge_recommendations(results, weights)
    â””â”€â†’ Create Recommendation objects
    â†“
Return List[Recommendation]
    â†“
Convert to List[Dict] for API compatibility
    â†“
User receives recommendations
```

### Search Flow (Three-Way Hybrid)

```
User Request
    â†“
FastAPI Router (POST /api/search/three-way)
    â†“
HybridSearchQuery(db, query, enable_reranking, adaptive_weights)
    â†“
execute()
    â†“
    â”œâ”€â†’ _ensure_tables_exist()
    â”œâ”€â†’ _check_services_available()
    â”œâ”€â†’ _analyze_query() â†’ query characteristics
    â”‚
    â”œâ”€â†’ PHASE 1: _execute_retrieval_phase()
    â”‚   â”œâ”€â†’ _search_fts5() â†’ FTS5 keyword results
    â”‚   â”œâ”€â†’ _search_dense() â†’ Dense vector results
    â”‚   â””â”€â†’ _search_sparse() â†’ Sparse vector results
    â”‚   â””â”€â†’ Return RetrievalCandidates
    â”‚
    â”œâ”€â†’ PHASE 2: _execute_fusion_phase(candidates)
    â”‚   â”œâ”€â†’ _compute_weights() â†’ adaptive RRF weights
    â”‚   â”œâ”€â†’ ReciprocalRankFusionService.fuse_results()
    â”‚   â”œâ”€â†’ _compute_method_contributions()
    â”‚   â””â”€â†’ Return FusedCandidates
    â”‚
    â”œâ”€â†’ PHASE 3: _execute_reranking_phase(fused)
    â”‚   â”œâ”€â†’ RerankingService.rerank() [if enabled]
    â”‚   â””â”€â†’ Return final ranked results
    â”‚
    â”œâ”€â†’ _fetch_paginated_resources(results)
    â”œâ”€â†’ _compute_facets(results)
    â””â”€â†’ _generate_snippets(resources)
    â†“
Return (resources, total, facets, snippets, metadata)
    â†“
Convert to JSON response
    â†“
User receives search results
```


### Refactoring Detection Flow

```
Developer runs CLI
    â†“
refactoring.cli.detect_smells(directory_path)
    â†“
CodeSmellDetector()
    â”œâ”€â†’ Initialize validators:
    â”‚   â”œâ”€â†’ FunctionLengthChecker()
    â”‚   â”œâ”€â†’ ClassSizeChecker()
    â”‚   â”œâ”€â†’ TypeHintCoverageChecker()
    â”‚   â””â”€â†’ CodeDuplicationDetector()
    â†“
analyze_directory(dir_path)
    â†“
    For each Python file:
    â”œâ”€â†’ analyze_file(file_path)
    â”‚   â”œâ”€â†’ FunctionLengthChecker.check_file()
    â”‚   â”‚   â”œâ”€â†’ Parse AST
    â”‚   â”‚   â”œâ”€â†’ _extract_functions()
    â”‚   â”‚   â”œâ”€â†’ _analyze_function()
    â”‚   â”‚   â””â”€â†’ _create_smell() if violation
    â”‚   â”‚
    â”‚   â”œâ”€â†’ ClassSizeChecker.check_file()
    â”‚   â”‚   â”œâ”€â†’ Parse AST
    â”‚   â”‚   â”œâ”€â†’ _extract_classes()
    â”‚   â”‚   â”œâ”€â†’ _analyze_class()
    â”‚   â”‚   â””â”€â†’ _create_smell() if violation
    â”‚   â”‚
    â”‚   â”œâ”€â†’ TypeHintCoverageChecker.check_file()
    â”‚   â”‚   â”œâ”€â†’ Parse AST
    â”‚   â”‚   â”œâ”€â†’ _has_complete_type_hints()
    â”‚   â”‚   â””â”€â†’ _create_smell() if missing
    â”‚   â”‚
    â”‚   â”œâ”€â†’ _detect_feature_envy()
    â”‚   â”œâ”€â†’ _detect_long_parameter_lists()
    â”‚   â”œâ”€â†’ _count_lines()
    â”‚   â””â”€â†’ _calculate_complexity()
    â”‚   â†“
    â”‚   Return SmellReport
    â”‚
    â””â”€â†’ CodeDuplicationDetector.check_files(all_files)
        â”œâ”€â†’ _extract_function_bodies()
        â”œâ”€â†’ Compare all pairs
        â”œâ”€â†’ _calculate_similarity()
        â””â”€â†’ _create_smell() if duplicate
    â†“
prioritize_smells(reports)
    â”œâ”€â†’ Sort by severity (HIGH, MEDIUM, LOW)
    â””â”€â†’ Return PrioritizedSmells
    â†“
generate_summary_report(reports)
    â†“
Display results to developer
```

---

## Design Patterns Used

### Domain-Driven Design (DDD)
- **Value Objects**: ClassificationPrediction, QualityScore, RecommendationScore, SearchQuery
- **Entities**: Resource, TaxonomyNode, User (via entity_id)
- **Domain Services**: Classification, Quality, Recommendation, Search domains
- **Validation**: Encapsulated in domain objects with validate() methods

### Strategy Pattern
- **Context**: RecommendationService
- **Strategy Interface**: RecommendationStrategy (ABC)
- **Concrete Strategies**: CollaborativeFilteringStrategy, ContentBasedStrategy, GraphBasedStrategy, HybridStrategy
- **Factory**: RecommendationStrategyFactory

### Factory Pattern
- **RecommendationStrategyFactory**: Creates strategy instances based on type
- **SessionLocal**: Creates database session instances

### Repository Pattern
- **Database Models**: Act as repositories for domain entities
- **Service Layer**: Abstracts database operations from business logic

### Dependency Injection
- **FastAPI Dependencies**: get_db() provides database sessions
- **Service Constructors**: Accept db: Session parameter

### Observer Pattern
- **PredictionMonitor**: Observes and logs ML predictions
- **AlertManager**: Observes metrics and triggers alerts

### Command Query Separation (CQS)
- **Query Methods**: get_*, compute_*, analyze_* (no side effects)
- **Command Methods**: create_*, update_*, delete_* (modify state)

### Builder Pattern
- **SearchQuery**: Builds complex search queries with optional parameters
- **ClassificationResult**: Builds results with predictions and metadata

---


## Key Architectural Principles

### 1. Separation of Concerns
- **Domain Layer**: Pure business logic, no infrastructure dependencies
- **Service Layer**: Orchestrates domain objects and infrastructure
- **Router Layer**: HTTP concerns only, delegates to services
- **Database Layer**: Data persistence only

### 2. Dependency Inversion
- High-level modules (services) don't depend on low-level modules (database)
- Both depend on abstractions (domain objects, interfaces)
- Database sessions injected via dependency injection

### 3. Single Responsibility
- Each class has one reason to change
- Domain objects: Represent business concepts
- Services: Implement business operations
- Validators: Check specific code quality aspects
- Routers: Handle HTTP requests/responses

### 4. Open/Closed Principle
- Open for extension: New strategies can be added without modifying existing code
- Closed for modification: Core abstractions remain stable
- Example: Adding new RecommendationStrategy doesn't change RecommendationService

### 5. Liskov Substitution
- All RecommendationStrategy implementations are interchangeable
- All ValueObject subclasses can be used polymorphically
- Domain objects can be substituted without breaking contracts

### 6. Interface Segregation
- Small, focused interfaces (RecommendationStrategy has one method)
- Clients depend only on methods they use
- No fat interfaces with unused methods

### 7. Don't Repeat Yourself (DRY)
- Common validation logic in base classes (BaseDomainObject)
- Shared utilities in utility layer
- Reusable validators in refactoring framework

### 8. Composition Over Inheritance
- HybridStrategy composes multiple strategies
- Services compose domain objects
- Minimal inheritance hierarchies

---

## Testing Architecture

### Unit Tests
```
test_domain_*.py
â”œâ”€â”€ Test domain object validation
â”œâ”€â”€ Test domain object methods
â”œâ”€â”€ Test value object immutability
â””â”€â”€ No database or external dependencies

test_*_service.py
â”œâ”€â”€ Test service methods with mocked database
â”œâ”€â”€ Test business logic
â”œâ”€â”€ Test error handling
â””â”€â”€ Use pytest fixtures for setup

test_refactoring_*.py
â”œâ”€â”€ Test code smell detection
â”œâ”€â”€ Test validators
â”œâ”€â”€ Test AST parsing
â””â”€â”€ Use sample code files
```

### Integration Tests
```
test_*_integration.py
â”œâ”€â”€ Test service + database interactions
â”œâ”€â”€ Test API endpoints
â”œâ”€â”€ Use test database
â””â”€â”€ Test complete workflows
```

### Test Fixtures
```
conftest.py
â”œâ”€â”€ @pytest.fixture: db_session
â”œâ”€â”€ @pytest.fixture: test_client
â”œâ”€â”€ @pytest.fixture: sample_resources
â””â”€â”€ @pytest.fixture: mock_ml_model
```

---

## Performance Considerations

### Lazy Loading
- ML models loaded on first use (MLClassificationService._load_model)
- Reduces startup time and memory usage

### Caching
- Model checkpoints cached on disk
- Embeddings cached in database
- Query results can be cached (future enhancement)

### Batch Processing
- predict_batch() for multiple classifications
- Batch quality outlier detection
- Vectorized operations in numpy

### Database Optimization
- Indexes on frequently queried fields (id, resource_id, user_id)
- JSON fields for flexible metadata
- Pagination for large result sets

### Async Operations
- FastAPI async endpoints (future enhancement)
- Background tasks for long-running operations
- Async database queries (future enhancement)

---

## Security Considerations

### Input Validation
- Pydantic schemas validate all API inputs
- Domain objects validate business rules
- SQL injection prevented by SQLAlchemy ORM

### Authentication & Authorization
- JWT tokens for API authentication (future enhancement)
- Role-based access control (future enhancement)
- Resource ownership validation

### Data Privacy
- User data anonymization options
- GDPR compliance considerations
- Audit logging for sensitive operations

---

## Deployment Architecture

```
Production Environment
â”œâ”€â”€ Load Balancer
â”‚   â””â”€â”€ Distributes traffic across instances
â”œâ”€â”€ Application Servers (multiple instances)
â”‚   â”œâ”€â”€ FastAPI application
â”‚   â”œâ”€â”€ Gunicorn workers
â”‚   â””â”€â”€ ML models loaded in memory
â”œâ”€â”€ Database Server
â”‚   â”œâ”€â”€ PostgreSQL (production)
â”‚   â””â”€â”€ SQLite (development)
â”œâ”€â”€ Cache Layer
â”‚   â””â”€â”€ Redis (future enhancement)
â””â”€â”€ Monitoring
    â”œâ”€â”€ Prometheus metrics
    â”œâ”€â”€ Grafana dashboards
    â””â”€â”€ Alert notifications
```

---

## Future Enhancements

### Planned Features
1. **Async Operations**: Convert services to async for better concurrency
2. **Caching Layer**: Add Redis for query result caching
3. **GraphQL API**: Alternative to REST for flexible queries
4. **Real-time Updates**: WebSocket support for live notifications
5. **Advanced ML**: Add more sophisticated models (BERT, GPT)
6. **Distributed Training**: Multi-GPU and distributed model training
7. **A/B Testing**: Framework for testing recommendation strategies
8. **Explainability**: Add SHAP/LIME for model interpretability

### Technical Debt
1. Complete async conversion of database operations
2. Add comprehensive API documentation (OpenAPI/Swagger)
3. Implement rate limiting and throttling
4. Add request/response compression
5. Implement circuit breakers for external services
6. Add distributed tracing (OpenTelemetry)

---

## Conclusion

This architecture diagram provides a complete view of the Neo Alexandria 2.0 system, showing:

- **Clear separation of concerns** across layers
- **Domain-Driven Design** with rich domain objects
- **Design patterns** (Strategy, Factory, Repository, etc.)
- **Comprehensive service layer** with business logic
- **Robust refactoring framework** for code quality
- **Complete data flow** from request to response
- **Testing strategy** for reliability
- **Performance optimizations** for scalability
- **Security considerations** for production readiness

The architecture is designed to be:
- **Maintainable**: Clear structure and separation of concerns
- **Extensible**: Easy to add new features and strategies
- **Testable**: Isolated components with clear interfaces
- **Scalable**: Stateless services that can be horizontally scaled
- **Reliable**: Comprehensive error handling and monitoring

For specific implementation details, refer to the individual module documentation and inline code comments.


---

## Phase 12 and Complete System Overview

For detailed Phase 12 (Fowler Refactoring Framework) diagrams and the complete system overview with performance metrics, see:

**[ARCHITECTURE_PHASE12.md](./ARCHITECTURE_PHASE12.md)**

This supplementary document includes:
- Phase 12 refactoring framework architecture
- Complete system overview diagram
- Full request lifecycle data flow
- Cross-cutting concerns
- Design patterns summary
- Performance metrics and characteristics



---

## Phase 12.5: Event-Driven Architecture

### Event-Driven System Overview

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    EVENT-DRIVEN ARCHITECTURE (Phase 12.5)                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                         Event System Core                            â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
â”‚  â”‚  â”‚                     EventEmitter (Singleton)                  â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ on(event_type, handler) - Register listener               â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ off(event_type, handler) - Unregister listener            â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ emit(event_type, data, priority) - Dispatch event         â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ get_event_history(limit) - Retrieve event log             â”‚  â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
â”‚  â”‚                                                                       â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
â”‚  â”‚  â”‚                    SystemEvent Enum                           â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  Resource: created, updated, deleted, content_changed         â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  Processing: ingestion, embedding, quality, classification    â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  User: interaction_tracked, profile_updated                   â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  System: cache_invalidated, search_index_updated              â”‚  â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                    Celery Distributed Task Queue                     â”‚   â”‚
â”‚  â”‚                                                                       â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚  â”‚  â”‚    Redis     â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”¤ Celery App   â”‚â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚   Workers   â”‚ â”‚   â”‚
â”‚  â”‚  â”‚   (Broker)   â”‚         â”‚  (celery_app)â”‚         â”‚  (4x nodes) â”‚ â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚  â”‚                                   â”‚                                  â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚  â”‚  â”‚                        Task Routing                            â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ urgent queue (priority 9) - Search index, cache             â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ high_priority queue (priority 7) - Embeddings               â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ ml_tasks queue (priority 5) - Classification, quality       â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ batch queue (priority 3) - Batch processing                 â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ default queue (priority 5) - General tasks                  â”‚ â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                      Event Hooks (Auto-Consistency)                  â”‚   â”‚
â”‚  â”‚                                                                       â”‚   â”‚
â”‚  â”‚  resource.content_changed â”€â”€â–º regenerate_embedding_task (5s delay)  â”‚   â”‚
â”‚  â”‚  resource.metadata_changed â”€â–º recompute_quality_task (10s delay)    â”‚   â”‚
â”‚  â”‚  resource.updated â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º update_search_index_task (1s delay)   â”‚   â”‚
â”‚  â”‚  citations.extracted â”€â”€â”€â”€â”€â”€â”€â”€â–º update_graph_edges_task (30s delay)  â”‚   â”‚
â”‚  â”‚  resource.updated â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º invalidate_cache_task (immediate)     â”‚   â”‚
â”‚  â”‚  user.interaction_tracked â”€â”€â”€â–º refresh_profile_task (every 10)      â”‚   â”‚
â”‚  â”‚  resource.created â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º classify_resource_task (20s delay)   â”‚   â”‚
â”‚  â”‚  authors.extracted â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º normalize_names_task (60s delay)     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Celery Task Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          CELERY TASK HIERARCHY                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                               â”‚
â”‚                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                 â”‚
â”‚                         â”‚  DatabaseTask    â”‚                                 â”‚
â”‚                         â”‚  (Base Class)    â”‚                                 â”‚
â”‚                         â”‚  â€¢ __call__()    â”‚                                 â”‚
â”‚                         â”‚  â€¢ Session mgmt  â”‚                                 â”‚
â”‚                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                 â”‚
â”‚                                  â”‚                                            â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚
â”‚         â”‚                        â”‚                        â”‚                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚ regenerate_     â”‚   â”‚ recompute_       â”‚   â”‚ update_search_   â”‚        â”‚
â”‚  â”‚ embedding_task  â”‚   â”‚ quality_task     â”‚   â”‚ index_task       â”‚        â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤        â”‚
â”‚  â”‚ â€¢ max_retries=3 â”‚   â”‚ â€¢ max_retries=2  â”‚   â”‚ â€¢ priority=9     â”‚        â”‚
â”‚  â”‚ â€¢ retry_delay=60â”‚   â”‚ â€¢ priority=5     â”‚   â”‚ â€¢ max_retries=3  â”‚        â”‚
â”‚  â”‚ â€¢ priority=7    â”‚   â”‚ â€¢ countdown=10   â”‚   â”‚ â€¢ countdown=1    â”‚        â”‚
â”‚  â”‚ â€¢ countdown=5   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                         â”‚
â”‚                                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚ update_graph_    â”‚   â”‚ classify_        â”‚   â”‚ invalidate_      â”‚       â”‚
â”‚  â”‚ edges_task       â”‚   â”‚ resource_task    â”‚   â”‚ cache_task       â”‚       â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤       â”‚
â”‚  â”‚ â€¢ priority=5     â”‚   â”‚ â€¢ max_retries=2  â”‚   â”‚ â€¢ priority=9     â”‚       â”‚
â”‚  â”‚ â€¢ countdown=30   â”‚   â”‚ â€¢ priority=5     â”‚   â”‚ â€¢ countdown=0    â”‚       â”‚
â”‚  â”‚ â€¢ batch_delay    â”‚   â”‚ â€¢ countdown=20   â”‚   â”‚ â€¢ pattern supportâ”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚                                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚ refresh_         â”‚   â”‚ batch_process_resources_task             â”‚       â”‚
â”‚  â”‚ recommendation_  â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤       â”‚
â”‚  â”‚ profile_task     â”‚   â”‚ â€¢ Progress tracking with update_state()  â”‚       â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚ â€¢ Operations: regenerate_embeddings,     â”‚       â”‚
â”‚  â”‚ â€¢ priority=3     â”‚   â”‚   recompute_quality                      â”‚       â”‚
â”‚  â”‚ â€¢ countdown=300  â”‚   â”‚ â€¢ Returns: processed_count, status       â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚                                                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Redis Caching Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        MULTI-LAYER REDIS CACHING                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                         RedisCache Class                             â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
â”‚  â”‚  â”‚  Methods:                                                     â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ get(key) â†’ value | None                                   â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ set(key, value, ttl) â†’ None                               â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ delete(key) â†’ None                                        â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ delete_pattern(pattern) â†’ int (count)                     â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ get_default_ttl(key) â†’ int (seconds)                      â”‚  â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
â”‚  â”‚                                                                       â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
â”‚  â”‚  â”‚                    CacheStats Tracking                        â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ hits: int                                                  â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ misses: int                                                â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ invalidations: int                                         â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ hit_rate() â†’ float (0.0-1.0)                               â”‚  â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                        Cache Key Strategy                            â”‚   â”‚
â”‚  â”‚                                                                       â”‚   â”‚
â”‚  â”‚  embedding:{resource_id}           TTL: 3600s (1 hour)              â”‚   â”‚
â”‚  â”‚  quality:{resource_id}             TTL: 1800s (30 minutes)           â”‚   â”‚
â”‚  â”‚  search_query:{hash}               TTL: 300s (5 minutes)             â”‚   â”‚
â”‚  â”‚  resource:{resource_id}            TTL: 600s (10 minutes)            â”‚   â”‚
â”‚  â”‚  graph:{resource_id}:neighbors     TTL: 1800s (30 minutes)           â”‚   â”‚
â”‚  â”‚  user:{user_id}:profile            TTL: 600s (10 minutes)            â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                    Cache Invalidation Patterns                       â”‚   â”‚
â”‚  â”‚                                                                       â”‚   â”‚
â”‚  â”‚  resource:{resource_id}:*          â†’ All resource-related caches     â”‚   â”‚
â”‚  â”‚  search_query:*                    â†’ All search result caches        â”‚   â”‚
â”‚  â”‚  graph:*                           â†’ All graph caches                â”‚   â”‚
â”‚  â”‚  user:{user_id}:*                  â†’ All user-related caches         â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Service Integration with Events

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    SERVICE LAYER EVENT INTEGRATION                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                       ResourceService                                â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
â”‚  â”‚  â”‚  create(data) â†’ Resource                                      â”‚  â”‚   â”‚
â”‚  â”‚  â”‚    1. Create resource in database                            â”‚  â”‚   â”‚
â”‚  â”‚  â”‚    2. Emit: resource.created                                 â”‚  â”‚   â”‚
â”‚  â”‚  â”‚    3. Hooks trigger: classify_resource_task                  â”‚  â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
â”‚  â”‚  â”‚  update(id, data) â†’ Resource                                 â”‚  â”‚   â”‚
â”‚  â”‚  â”‚    1. Update resource in database                            â”‚  â”‚   â”‚
â”‚  â”‚  â”‚    2. Detect changes (content vs metadata)                   â”‚  â”‚   â”‚
â”‚  â”‚  â”‚    3. Emit: resource.updated                                 â”‚  â”‚   â”‚
â”‚  â”‚  â”‚    4. Emit: resource.content_changed (if content changed)    â”‚  â”‚   â”‚
â”‚  â”‚  â”‚    5. Emit: resource.metadata_changed (if metadata changed)  â”‚  â”‚   â”‚
â”‚  â”‚  â”‚    6. Hooks trigger:                                         â”‚  â”‚   â”‚
â”‚  â”‚  â”‚       - regenerate_embedding_task (if content)               â”‚  â”‚   â”‚
â”‚  â”‚  â”‚       - recompute_quality_task (if metadata)                 â”‚  â”‚   â”‚
â”‚  â”‚  â”‚       - update_search_index_task (always)                    â”‚  â”‚   â”‚
â”‚  â”‚  â”‚       - invalidate_cache_task (always)                       â”‚  â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                      IngestionService                                â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
â”‚  â”‚  â”‚  process(url) â†’ Resource                                     â”‚  â”‚   â”‚
â”‚  â”‚  â”‚    1. Emit: ingestion.started                                â”‚  â”‚   â”‚
â”‚  â”‚  â”‚    2. Fetch and extract content                              â”‚  â”‚   â”‚
â”‚  â”‚  â”‚    3. Generate embeddings                                    â”‚  â”‚   â”‚
â”‚  â”‚  â”‚    4. Extract citations â†’ Emit: citations.extracted          â”‚  â”‚   â”‚
â”‚  â”‚  â”‚    5. Extract authors â†’ Emit: authors.extracted              â”‚  â”‚   â”‚
â”‚  â”‚  â”‚    6. Compute quality                                        â”‚  â”‚   â”‚
â”‚  â”‚  â”‚    7. Create resource â†’ Emit: resource.created               â”‚  â”‚   â”‚
â”‚  â”‚  â”‚    8. Emit: ingestion.completed                              â”‚  â”‚   â”‚
â”‚  â”‚  â”‚    9. Hooks trigger all downstream tasks                     â”‚  â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                   UserInteractionTracking                            â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
â”‚  â”‚  â”‚  track_interaction(user_id, resource_id, type) â†’ None        â”‚  â”‚   â”‚
â”‚  â”‚  â”‚    1. Record interaction in database                         â”‚  â”‚   â”‚
â”‚  â”‚  â”‚    2. Get total interaction count for user                   â”‚  â”‚   â”‚
â”‚  â”‚  â”‚    3. Emit: user.interaction_tracked                         â”‚  â”‚   â”‚
â”‚  â”‚  â”‚    4. Hook checks: if count % 10 == 0                        â”‚  â”‚   â”‚
â”‚  â”‚  â”‚       â†’ refresh_recommendation_profile_task                  â”‚  â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Docker Compose Service Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      DOCKER COMPOSE ORCHESTRATION                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                            Redis                                     â”‚   â”‚
â”‚  â”‚  â€¢ Image: redis:7-alpine                                            â”‚   â”‚
â”‚  â”‚  â€¢ Memory: 2GB with allkeys-lru eviction                            â”‚   â”‚
â”‚  â”‚  â€¢ Persistence: appendonly yes                                      â”‚   â”‚
â”‚  â”‚  â€¢ Port: 6379                                                       â”‚   â”‚
â”‚  â”‚  â€¢ Health check: redis-cli ping                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                    â”‚                                          â”‚
â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                        â”‚
â”‚                    â”‚               â”‚               â”‚                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚  Celery Workers    â”‚  â”‚  Celery Beat    â”‚  â”‚     Flower          â”‚     â”‚
â”‚  â”‚  (4 replicas)      â”‚  â”‚  (Scheduler)    â”‚  â”‚   (Monitoring)      â”‚     â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤     â”‚
â”‚  â”‚ â€¢ Concurrency: 4   â”‚  â”‚ â€¢ Schedules:    â”‚  â”‚ â€¢ Port: 5555        â”‚     â”‚
â”‚  â”‚ â€¢ CPU: 2 cores     â”‚  â”‚   - Daily 2 AM  â”‚  â”‚ â€¢ Web dashboard     â”‚     â”‚
â”‚  â”‚ â€¢ Memory: 2GB      â”‚  â”‚   - Weekly Sun  â”‚  â”‚ â€¢ Task monitoring   â”‚     â”‚
â”‚  â”‚ â€¢ Queues: all      â”‚  â”‚   - Monthly 1st â”‚  â”‚ â€¢ Worker stats      â”‚     â”‚
â”‚  â”‚ â€¢ Auto-restart     â”‚  â”‚   - Daily 4 AM  â”‚  â”‚ â€¢ Real-time graphs  â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                         FastAPI Application                          â”‚   â”‚
â”‚  â”‚  â€¢ Depends on: Redis                                                â”‚   â”‚
â”‚  â”‚  â€¢ Environment: CELERY_BROKER_URL, CELERY_RESULT_BACKEND           â”‚   â”‚
â”‚  â”‚  â€¢ Startup: register_all_hooks(), initialize Redis cache            â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Data Flow: Resource Update with Event Cascade

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              RESOURCE UPDATE EVENT CASCADE (Phase 12.5)                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                               â”‚
â”‚  1. API Request: PUT /resources/{id}                                         â”‚
â”‚     â”‚                                                                          â”‚
â”‚     â–¼                                                                          â”‚
â”‚  2. ResourceService.update(id, data)                                         â”‚
â”‚     â”‚                                                                          â”‚
â”‚     â”œâ”€â–º Update database                                                      â”‚
â”‚     â”‚                                                                          â”‚
â”‚     â”œâ”€â–º Detect changes: content_changed = True, metadata_changed = False     â”‚
â”‚     â”‚                                                                          â”‚
â”‚     â”œâ”€â–º Emit: resource.updated                                               â”‚
â”‚     â”‚   â””â”€â–º Hook: on_resource_updated_sync_search_index                      â”‚
â”‚     â”‚       â””â”€â–º Queue: update_search_index_task (priority=9, countdown=1s)   â”‚
â”‚     â”‚                                                                          â”‚
â”‚     â”œâ”€â–º Emit: resource.updated                                               â”‚
â”‚     â”‚   â””â”€â–º Hook: on_resource_updated_invalidate_caches                      â”‚
â”‚     â”‚       â””â”€â–º Queue: invalidate_cache_task (priority=9, countdown=0s)      â”‚
â”‚     â”‚           â””â”€â–º Invalidate: resource:{id}:*, search_query:*              â”‚
â”‚     â”‚                                                                          â”‚
â”‚     â””â”€â–º Emit: resource.content_changed                                       â”‚
â”‚         â””â”€â–º Hook: on_content_changed_regenerate_embedding                    â”‚
â”‚             â””â”€â–º Queue: regenerate_embedding_task (priority=7, countdown=5s)  â”‚
â”‚                 â””â”€â–º Generate embedding â†’ Store in cache                      â”‚
â”‚                                                                               â”‚
â”‚  3. Celery Workers Process Tasks (in parallel)                               â”‚
â”‚     â”‚                                                                          â”‚
â”‚     â”œâ”€â–º Worker 1: update_search_index_task (1s delay)                        â”‚
â”‚     â”‚   â””â”€â–º Update FTS5 index â†’ Resource searchable                          â”‚
â”‚     â”‚                                                                          â”‚
â”‚     â”œâ”€â–º Worker 2: invalidate_cache_task (immediate)                          â”‚
â”‚     â”‚   â””â”€â–º Delete cache keys â†’ Fresh data on next request                   â”‚
â”‚     â”‚                                                                          â”‚
â”‚     â””â”€â–º Worker 3: regenerate_embedding_task (5s delay)                       â”‚
â”‚         â””â”€â–º Generate embedding â†’ Cache â†’ Enable semantic search              â”‚
â”‚                                                                               â”‚
â”‚  4. All tasks complete within 10 seconds                                     â”‚
â”‚     â””â”€â–º Resource fully updated and consistent across all systems             â”‚
â”‚                                                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Performance Characteristics

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    PHASE 12.5 PERFORMANCE METRICS                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                               â”‚
â”‚  Scalability:                                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  â€¢ 100+ concurrent ingestions without degradation                   â”‚   â”‚
â”‚  â”‚  â€¢ Linear throughput scaling with worker count                      â”‚   â”‚
â”‚  â”‚  â€¢ Horizontal scaling across multiple machines                      â”‚   â”‚
â”‚  â”‚  â€¢ 4 workers â†’ 400 tasks/minute                                     â”‚   â”‚
â”‚  â”‚  â€¢ 8 workers â†’ 800 tasks/minute (linear)                            â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                               â”‚
â”‚  Cache Performance:                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  â€¢ 60-70% cache hit rate for repeated operations                    â”‚   â”‚
â”‚  â”‚  â€¢ 50-70% computation reduction through caching                     â”‚   â”‚
â”‚  â”‚  â€¢ Sub-millisecond cache lookups                                    â”‚   â”‚
â”‚  â”‚  â€¢ Pattern-based invalidation in <10ms                              â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                               â”‚
â”‚  Task Reliability:                                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  â€¢ <1% task failure rate with automatic retries                     â”‚   â”‚
â”‚  â”‚  â€¢ Exponential backoff for transient errors                         â”‚   â”‚
â”‚  â”‚  â€¢ Dead letter queue for permanent failures                         â”‚   â”‚
â”‚  â”‚  â€¢ Task acknowledgment after completion                             â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                               â”‚
â”‚  Search Index Updates:                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  â€¢ Complete within 5 seconds of resource updates                    â”‚   â”‚
â”‚  â”‚  â€¢ URGENT priority ensures immediate searchability                  â”‚   â”‚
â”‚  â”‚  â€¢ Automatic retry on failure                                       â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                               â”‚
â”‚  Database Connection Pooling:                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  â€¢ 20 base connections + 40 overflow = 60 total                     â”‚   â”‚
â”‚  â”‚  â€¢ Connection recycling after 1 hour                                â”‚   â”‚
â”‚  â”‚  â€¢ Pre-ping health checks                                           â”‚   â”‚
â”‚  â”‚  â€¢ Handles 100+ concurrent requests                                 â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

